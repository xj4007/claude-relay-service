# å¾®ä¿¡å°ç¨‹åºæŠ€æœ¯å®æ–½æ–¹æ¡ˆ - å°å·¾å†’åŠ©æ‰‹

## é¡¹ç›®æ¦‚è¿°

**å°ç¨‹åºåç§°ï¼šå°å·¾å†’åŠ©æ‰‹**

åŸºäºç°æœ‰ Claude Relay Service (CRS) çš„åŸºç¡€ï¼Œæ–°å¢å¾®ä¿¡å°ç¨‹åºä¸šåŠ¡æ¨¡å—ï¼Œä¸ºç”¨æˆ·æä¾›ä¾¿æ·çš„ç§»åŠ¨ç«¯ API Key ç®¡ç†æœåŠ¡ã€‚

**è®¾è®¡ç†å¿µï¼š**

- ğŸ¨ **æç®€é»‘ç™½é£æ ¼**ï¼šç±»ä¼¼ ChatGPT çš„ç®€æ´ç•Œé¢
- ğŸ“± **ä¹å®«æ ¼èœå•**ï¼šé¦–é¡µé‡‡ç”¨ä¹å®«æ ¼å¸ƒå±€ï¼ŒåŠŸèƒ½æ¸…æ™°
- ğŸ”“ **æ— éœ€ç™»å½•**ï¼šæ‰€æœ‰åŠŸèƒ½æ— éœ€ç™»å½•å³å¯è®¿é—®ï¼Œé€šè¿‡ API Key è¿›è¡Œèº«ä»½è¯†åˆ«
- ğŸ”‘ **Key ä¸ºä¸­å¿ƒ**ï¼šæ‰€æœ‰æŸ¥è¯¢å’Œæ“ä½œéƒ½åŸºäºç”¨æˆ·é…ç½®çš„ API Key

**MVP æ ¸å¿ƒåŠŸèƒ½ï¼š**

- Key ç®¡ç†é…ç½®ï¼ˆæœ¬åœ°å­˜å‚¨ï¼Œæ— éœ€ç™»å½•ï¼‰
- æ¯æ—¥ç­¾åˆ°é¢†ç§¯åˆ†ï¼ˆåŸºäº Keyï¼‰
- ä½™é¢æŸ¥è¯¢å’Œç»Ÿè®¡ï¼ˆåŸºäº Keyï¼‰
- æ¶ˆè´¹æ—¥å¿—æŸ¥çœ‹ï¼ˆåŸºäº Keyï¼‰
- åœ¨çº¿å……å€¼æ”¯ä»˜ï¼ˆåŸºäº Keyï¼‰

---

## 1. æ¶æ„æ–¹æ¡ˆ

### 1.1 æ ¸å¿ƒè®¾è®¡ç†å¿µ

**è½»é‡çº§å¾®ä¿¡ç™»å½•æ¶æ„ï¼š**

- âœ… ä½¿ç”¨å¾®ä¿¡é™é»˜æˆæƒè·å– openidï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰
- âœ… openid ä»…ç”¨äºï¼šå¾®ä¿¡æ”¯ä»˜ã€ç­¾åˆ°é™åˆ¶ã€æ“ä½œå®¡è®¡
- âœ… ä¸åˆ›å»ºç‹¬ç«‹çš„ç”¨æˆ·è´¦æˆ·ä½“ç³»
- âœ… API Key æ˜¯æ ¸å¿ƒ"è´¦æˆ·"æ¦‚å¿µ
- âœ… æ”¯æŒå¤šä¸ª API Key ç®¡ç†å’Œåˆ‡æ¢

**Key ç®¡ç†æœºåˆ¶ï¼š**

```
ç”¨æˆ·é¦–æ¬¡æ‰“å¼€å°ç¨‹åº
    â†“
wx.login() é™é»˜è·å– openidï¼ˆåå°è‡ªåŠ¨å®Œæˆï¼‰
    â†“
æ˜¾ç¤º Key é…ç½®å¼•å¯¼
    â†“
ç”¨æˆ·è¾“å…¥å®Œæ•´ API Keyï¼ˆcr_xxx æ ¼å¼ï¼Œä¸æ”¯æŒè¾“å…¥åç§°ï¼‰
    â†“
éªŒè¯ Key æœ‰æ•ˆæ€§ï¼ˆè°ƒç”¨ CRS åç«¯ï¼‰
    â†“
ä¿å­˜åˆ°æœ¬åœ° Storage
    â†“
å¼€å§‹ä½¿ç”¨å„é¡¹åŠŸèƒ½ï¼ˆç­¾åˆ°ã€å……å€¼ã€æŸ¥è¯¢ç­‰ï¼‰
```

**CRS API Key ç»“æ„è¯´æ˜ï¼š**

æ ¹æ® `apiKeyService.js` çš„å®ç°ï¼ŒAPI Key åŒ…å«ä»¥ä¸‹å…³é”®ä¿¡æ¯ï¼š

- **åŸºæœ¬ä¿¡æ¯**ï¼šid, name, description
- **æƒé™æ§åˆ¶**ï¼špermissions (all/claude/gemini/openai/droid)
- **é…é¢é™åˆ¶**ï¼šdailyCostLimit, totalCostLimit, weeklyOpusCostLimit
- **æ¨¡å‹é™åˆ¶**ï¼šenableModelRestriction, restrictedModels
- **å®¢æˆ·ç«¯é™åˆ¶**ï¼šenableClientRestriction, allowedClients
- **é€Ÿç‡é™åˆ¶**ï¼šrateLimitWindow, rateLimitRequests, rateLimitCost
- **å¹¶å‘æ§åˆ¶**ï¼šconcurrencyLimit
- **è¿‡æœŸç®¡ç†**ï¼šexpiresAt, expirationMode, activationDays
- **å…³è”è´¦æˆ·**ï¼šclaudeAccountId, geminiAccountId, openaiAccountId ç­‰

å°ç¨‹åºå°†åˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥ï¼š

1. éªŒè¯ Key çš„æœ‰æ•ˆæ€§å’Œæƒé™
2. æ˜¾ç¤ºé…é¢å’Œä½¿ç”¨æƒ…å†µ
3. æ§åˆ¶å¯ç”¨åŠŸèƒ½ï¼ˆæ ¹æ® permissionsï¼‰
4. å±•ç¤ºæˆæœ¬ç»Ÿè®¡
5. å……å€¼å’Œç­¾åˆ°åŠŸèƒ½ç›´æ¥ä¿®æ”¹ totalCostLimitï¼ˆæ‰©å±•é…é¢ï¼‰

### 1.2 æ¶æ„å†³ç­–

**é‡‡ç”¨æ–¹æ¡ˆï¼šæ‰©å±•ç°æœ‰ CRS**

**æ ¸å¿ƒä¼˜åŠ¿ï¼š**

- å¤ç”¨ç°æœ‰çš„ API Key éªŒè¯å’Œç®¡ç†ç³»ç»Ÿ
- å…±äº« Redisã€æ—¥å¿—ç³»ç»Ÿã€æˆæœ¬è®¡ç®—
- è½»é‡çº§å¾®ä¿¡ç™»å½•ï¼ˆä»…ç”¨äºæ”¯ä»˜å’Œç­¾åˆ°é™åˆ¶ï¼‰
- å‡å°‘é‡å¤ä»£ç å’Œé…ç½®
- ç»´æŠ¤æˆæœ¬ä½ï¼Œå¼€å‘æ•ˆç‡é«˜
- Key æ‰€æœ‰æƒå®Œå…¨å¼€æ”¾ï¼ˆä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½ä½¿ç”¨ï¼‰

**æ–°å¢æ¨¡å—ï¼š**

- å¾®ä¿¡ç™»å½•æœåŠ¡ï¼ˆè½»é‡çº§ï¼Œé™é»˜æˆæƒï¼‰
- å¾®ä¿¡å°ç¨‹åº Key éªŒè¯æœåŠ¡
- ç­¾åˆ°ç®¡ç†æœåŠ¡ï¼ˆåŸºäº Key + openid é™åˆ¶ï¼‰
- å……å€¼æœåŠ¡ï¼ˆæ‰©å±• Key é…é¢ + è®°å½•æ”¯ä»˜è€…ï¼‰
- æ¶ˆè´¹æ—¥å¿—æœåŠ¡ï¼ˆåŸºäº Keyï¼‰
- é…é¢å˜æ›´å†å²æœåŠ¡ï¼ˆ12 å°æ—¶å®¡è®¡ï¼‰

**ä¿®æ”¹å†…å®¹ï¼š**

- æ–°å¢å¾®ä¿¡ç›¸å…³çš„è·¯ç”± `wechatRoutes.js`
- æ–°å¢å¾®ä¿¡ä¸šåŠ¡æœåŠ¡æ–‡ä»¶
- æ‰©å±• API Key éªŒè¯æ”¯æŒå°ç¨‹åºåœºæ™¯
- å…è®¸é€šè¿‡å……å€¼/ç­¾åˆ°ä¿®æ”¹ totalCostLimit

---

## 2. é¡¹ç›®ç›®å½•ç»“æ„

### 2.1 æ–°å¢ç›®å½•ç»“æ„

```
claude-relay-service/
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ admin-spa/                      # ç°æœ‰ç®¡ç†åå°ï¼ˆPC Webï¼‰
â”‚   â””â”€â”€ wechat-miniapp/                 # æ–°å¢ï¼šå¾®ä¿¡å°ç¨‹åºé¡¹ç›®
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ pages/                  # å°ç¨‹åºé¡µé¢
â”‚       â”‚   â”‚   â”œâ”€â”€ index/              # é¦–é¡µï¼ˆä¹å®«æ ¼èœå•ï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ key-manage/         # Key ç®¡ç†é¡µé¢
â”‚       â”‚   â”‚   â”œâ”€â”€ checkin/            # ç­¾åˆ°é¡µé¢
â”‚       â”‚   â”‚   â”œâ”€â”€ balance/            # ä½™é¢æŸ¥è¯¢
â”‚       â”‚   â”‚   â”œâ”€â”€ logs/               # æ¶ˆè´¹æ—¥å¿—
â”‚       â”‚   â”‚   â””â”€â”€ recharge/           # å……å€¼é¡µé¢
â”‚       â”‚   â”œâ”€â”€ components/             # å¯å¤ç”¨ç»„ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ key-selector/       # Key é€‰æ‹©å™¨ç»„ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ key-config-guide/   # Key é…ç½®å¼•å¯¼ç»„ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ cost-stats/         # æ¶ˆè´¹ç»Ÿè®¡ç»„ä»¶
â”‚       â”‚   â”‚   â””â”€â”€ common/             # é€šç”¨ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ services/               # å°ç¨‹åºä¸šåŠ¡æœåŠ¡
â”‚       â”‚   â”‚   â”œâ”€â”€ apiService.js       # åç«¯ API è°ƒç”¨
â”‚       â”‚   â”‚   â”œâ”€â”€ storageService.js   # æœ¬åœ°å­˜å‚¨ï¼ˆKey ç®¡ç†ï¼‰
â”‚       â”‚   â”‚   â””â”€â”€ keyService.js       # Key éªŒè¯å’Œç®¡ç†æœåŠ¡
â”‚       â”‚   â”œâ”€â”€ stores/                 # çŠ¶æ€ç®¡ç†ï¼ˆPiniaï¼‰
â”‚       â”‚   â”‚   â”œâ”€â”€ key.js              # Key çŠ¶æ€ç®¡ç†
â”‚       â”‚   â”‚   â””â”€â”€ app.js              # åº”ç”¨å…¨å±€çŠ¶æ€
â”‚       â”‚   â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚       â”‚   â”‚   â”œâ”€â”€ request.js          # HTTP è¯·æ±‚å°è£…
â”‚       â”‚   â”‚   â”œâ”€â”€ storage.js          # å­˜å‚¨å·¥å…·
â”‚       â”‚   â”‚   â”œâ”€â”€ formatter.js        # æ•°æ®æ ¼å¼åŒ–
â”‚       â”‚   â”‚   â””â”€â”€ validator.js        # éªŒè¯å·¥å…·
â”‚       â”‚   â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚       â”‚   â”‚   â”œâ”€â”€ api.js              # API ç«¯ç‚¹é…ç½®
â”‚       â”‚   â”‚   â””â”€â”€ constants.js        # å¸¸é‡å®šä¹‰
â”‚       â”‚   â”œâ”€â”€ app.vue                 # åº”ç”¨ä¸»ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ main.js                 # åº”ç”¨å…¥å£
â”‚       â”‚   â”œâ”€â”€ manifest.json           # uni-app é…ç½®
â”‚       â”‚   â”œâ”€â”€ pages.json              # é¡µé¢è·¯ç”±é…ç½®
â”‚       â”‚   â”œâ”€â”€ app.wxss                # å°ç¨‹åºå…¨å±€æ ·å¼
â”‚       â”‚   â””â”€â”€ project.config.json     # å¾®ä¿¡å¼€å‘å·¥å…·é¡¹ç›®é…ç½®
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ README.md
â”‚       â””â”€â”€ dist/                       # æ„å»ºè¾“å‡º
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ wechatAuthService.js        # æ–°å¢ï¼šå¾®ä¿¡ç™»å½•æœåŠ¡ï¼ˆè½»é‡çº§ï¼‰
â”‚   â”‚   â”œâ”€â”€ checkinService.js           # æ–°å¢ï¼šç­¾åˆ°ä¸šåŠ¡æœåŠ¡ï¼ˆåŸºäº Key + openid é™åˆ¶ï¼‰
â”‚   â”‚   â”œâ”€â”€ rechargeService.js          # æ–°å¢ï¼šå……å€¼ä¸šåŠ¡æœåŠ¡ï¼ˆæ‰©å±• Key é…é¢ï¼‰
â”‚   â”‚   â”œâ”€â”€ consumeLogService.js        # æ–°å¢ï¼šæ¶ˆè´¹æ—¥å¿—æœåŠ¡ï¼ˆåŸºäº Keyï¼‰
â”‚   â”‚   â””â”€â”€ quotaHistoryService.js      # æ–°å¢ï¼šé…é¢å˜æ›´å†å²æœåŠ¡ï¼ˆ12 å°æ—¶ï¼‰
â”‚   â”‚
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ wechatRoutes.js             # æ–°å¢ï¼šå¾®ä¿¡å°ç¨‹åºè·¯ç”±
â”‚   â”‚   â””â”€â”€ api.js                      # ä¿®æ”¹ï¼šæ·»åŠ å¾®ä¿¡ç›¸å…³ç«¯ç‚¹
â”‚   â”‚
â”‚   â””â”€â”€ middleware/
â”‚       â”œâ”€â”€ wechatAuth.js               # æ–°å¢ï¼šå¾®ä¿¡ openid éªŒè¯ä¸­é—´ä»¶
â”‚       â””â”€â”€ wechatApiKey.js             # æ–°å¢ï¼šå¾®ä¿¡å°ç¨‹åº Key éªŒè¯ä¸­é—´ä»¶
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ wechat.js                       # æ–°å¢ï¼šå¾®ä¿¡é…ç½®ï¼ˆæ”¯ä»˜ç›¸å…³ï¼‰
â”‚   â””â”€â”€ config.js                       # ä¿®æ”¹ï¼šæ·»åŠ å¾®ä¿¡é…ç½®é¡¹
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ setup-wechat.js                 # æ–°å¢ï¼šå¾®ä¿¡é…ç½®åˆå§‹åŒ–è„šæœ¬
â”‚
â””â”€â”€ docs/
    â””â”€â”€ å¾®ä¿¡å°ç¨‹åº/
        â”œâ”€â”€ wechat_miniapp_business_plan.md # æœ¬æ–‡æ¡£
        â”œâ”€â”€ wechat_api_design.md            # æ–°å¢ï¼šå¾®ä¿¡å°ç¨‹åº API æ–‡æ¡£
        â”œâ”€â”€ ui_design.md                    # æ–°å¢ï¼šUI è®¾è®¡æ–‡æ¡£ï¼ˆä¹å®«æ ¼+æç®€é£æ ¼ï¼‰
        â””â”€â”€ deployment_guide.md             # æ–°å¢ï¼šéƒ¨ç½²æŒ‡å—
```

---

## 3. åŠŸèƒ½è§„åˆ’è¯¦è§£

### 3.1 Key ç®¡ç†é…ç½®ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰

#### åŠŸèƒ½è¯´æ˜

- **é¦–æ¬¡è¿›å…¥å¼•å¯¼**ï¼šé¦–æ¬¡æ‰“å¼€å°ç¨‹åºæ—¶æ˜¾ç¤º Key é…ç½®å¼•å¯¼
- **é™é»˜å¾®ä¿¡ç™»å½•**ï¼šè‡ªåŠ¨è°ƒç”¨ wx.login() è·å– openidï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰
- **å¤š Key æ”¯æŒ**ï¼šæ”¯æŒæ·»åŠ å’Œç®¡ç†å¤šä¸ªå·²æœ‰çš„ API Keyï¼ˆKey åœ¨ CRS åç«¯åˆ›å»ºï¼‰
- **æœ¬åœ°å­˜å‚¨**ï¼šæ·»åŠ çš„ Key å­˜å‚¨åœ¨å°ç¨‹åºæœ¬åœ°ï¼ˆä½¿ç”¨å¾®ä¿¡ Storage APIï¼‰
- **å•ä¸€è¾“å…¥æ¨¡å¼**ï¼šâœ… åªæ”¯æŒè¾“å…¥å®Œæ•´å¯†é’¥ï¼ˆcr_xxxï¼‰ï¼Œä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢
- **Key åˆ‡æ¢**ï¼šé€šè¿‡ä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢å½“å‰ä½¿ç”¨çš„ API Keyï¼ˆä¸å¯è¾“å…¥ï¼‰
- **Key éªŒè¯**ï¼šè¾“å…¥ Key åè‡ªåŠ¨è°ƒç”¨åç«¯éªŒè¯æœ‰æ•ˆæ€§
- **Key è¯¦æƒ…**ï¼šæ˜¾ç¤º Key çš„åç§°ã€æƒé™ã€é…é¢ç­‰ä¿¡æ¯
- **å¼€æ”¾ä½¿ç”¨**ï¼šä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½æ·»åŠ å’Œä½¿ç”¨è¯¥ Keyï¼ˆæ— æ‰€æœ‰æƒé™åˆ¶ï¼‰

#### Key æ·»åŠ æµç¨‹ï¼ˆä»…æ”¯æŒå®Œæ•´å¯†é’¥ï¼‰

**æ ‡å‡†æ¨¡å¼ï¼šæŒ‰å®Œæ•´å¯†é’¥æ·»åŠ **

```
åœºæ™¯ï¼šç”¨æˆ·åœ¨ PC ç®¡ç†åå°åˆ›å»ºäº† Keyï¼Œå¤åˆ¶å®Œæ•´å¯†é’¥åˆ°å°ç¨‹åº
æµç¨‹ï¼š
1. ç”¨æˆ·è¾“å…¥å®Œæ•´çš„ API Keyï¼ˆå¦‚ "cr_abc123xyz..."ï¼‰
2. å°ç¨‹åºéªŒè¯æ ¼å¼ï¼ˆå¿…é¡»ä»¥ cr_ å¼€å¤´ï¼‰
3. è°ƒç”¨åç«¯ POST /wechat/key/validate éªŒè¯ï¼ˆé™„å¸¦ openidï¼‰
4. åç«¯éªŒè¯ Key æœ‰æ•ˆæ€§ï¼Œè¿”å› Key çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåç§°ã€æƒé™ã€é…é¢ç­‰ï¼‰
5. éªŒè¯æˆåŠŸåï¼Œå°† Key ä¿å­˜åˆ°æœ¬åœ°ç¼“å­˜
6. åç»­é€šè¿‡ä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ Key

å®‰å…¨è¯´æ˜ï¼š
- ä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢ï¼ˆé˜²æ­¢æ³„éœ²æ‰€æœ‰ Key åç§°åˆ—è¡¨ï¼‰
- ä»»ä½•çŸ¥é“å®Œæ•´å¯†é’¥çš„äººéƒ½èƒ½æ·»åŠ å’Œä½¿ç”¨
- å¯†é’¥ä¿å¯†è´£ä»»ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…
```

#### Key æ·»åŠ é¡µé¢è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æ·»åŠ  API Key                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  è¾“å…¥å®Œæ•´å¯†é’¥:                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ cr_abc123...                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                      â”‚
â”‚  ğŸ’¡ æç¤º:                            â”‚
â”‚  â€¢ è¯·è¾“å…¥å®Œæ•´å¯†é’¥ (cr_ å¼€å¤´)        â”‚
â”‚  â€¢ Key éœ€è¦åœ¨ PC ç®¡ç†åå°åˆ›å»º       â”‚
â”‚  â€¢ ä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½ä½¿ç”¨         â”‚
â”‚  â€¢ è¯·å¦¥å–„ä¿ç®¡æ‚¨çš„å¯†é’¥               â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [éªŒè¯å¹¶æ·»åŠ ]                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Key åˆ—è¡¨å’Œç®¡ç†é¡µé¢ï¼ˆä¸‹æ‹‰é€‰æ‹©å™¨ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æˆ‘çš„ API Keys                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å½“å‰ä½¿ç”¨ Key:                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ MyApp                    â–¼  â”‚   â”‚  â† ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  ä¸‹æ‹‰é€‰é¡¹åˆ—è¡¨:                       â”‚
â”‚  â€¢ MyApp (all) - æ´»è·ƒ              â”‚
â”‚  â€¢ TestKey (claude) - æ´»è·ƒ         â”‚
â”‚                                      â”‚
â”‚  å½“å‰ Key è¯¦æƒ…:                      â”‚
â”‚  â”œâ”€ åç§°: MyApp                     â”‚
â”‚  â”œâ”€ å¯†é’¥: cr_abc123... (éšè—)      â”‚
â”‚  â”œâ”€ æƒé™: all                       â”‚
â”‚  â”œâ”€ çŠ¶æ€: æ´»è·ƒ                      â”‚
â”‚  â”œâ”€ é…é¢: Â¥9,765 / Â¥10,000         â”‚
â”‚  â””â”€ æ·»åŠ æ—¶é—´: 2024-01-15           â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [+ æ·»åŠ æ–° Key]              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ğŸ—‘ ç§»é™¤å½“å‰ Key]            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æ³¨æ„ï¼šæ‰€æœ‰é¡µé¢çš„ Key é€‰æ‹©éƒ½é‡‡ç”¨ä¸‹æ‹‰é€‰æ‹©å™¨ï¼Œä¸æ”¯æŒè¾“å…¥
```

#### åç«¯ API ç«¯ç‚¹

```
POST /wechat/auth/login
- å¾®ä¿¡é™é»˜ç™»å½•ï¼ˆè·å– openidï¼‰
- è¯·æ±‚å‚æ•°: {
    code: "wx_login_code"  // wx.login() è·å–çš„ä¸´æ—¶ç™»å½•å‡­è¯
  }
- è¿”å›æˆåŠŸ: {
    openid: "oABC123...",
    sessionKey: "encrypted...",
    isNewUser: true  // æ˜¯å¦é¦–æ¬¡ç™»å½•
  }

POST /wechat/key/validate
- éªŒè¯å®Œæ•´ API Key å¯†é’¥ï¼ˆä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢ï¼‰
- è¯·æ±‚å‚æ•°: {
    apiKey: "cr_xxx"  // å¿…é¡»æ˜¯å®Œæ•´å¯†é’¥
  }
- è¯·æ±‚å¤´: X-Wechat-Openid: oABC123...
- è¿”å›æˆåŠŸ: {
    valid: true,
    keyData: {
      keyId: "uuid",
      name: "MyApp",
      permissions: "all",
      isActive: true,
      expiresAt: "2025-12-31",
      dailyCostLimit: 100,
      totalCostLimit: 5000,
      currentDailyCost: 12.50,
      currentTotalCost: 2345.67
    }
  }
- è¿”å›å¤±è´¥: {
    valid: false,
    message: "Key ä¸å­˜åœ¨ã€å·²è¿‡æœŸæˆ–æ ¼å¼é”™è¯¯"
  }

GET /wechat/key/info
- è·å–å½“å‰ Key çš„è¯¦ç»†ä¿¡æ¯ï¼ˆåŒ…æ‹¬æƒé™ã€é…é¢ã€ä½¿ç”¨ç»Ÿè®¡ç­‰ï¼‰
- è¯·æ±‚å¤´:
    X-API-Key: cr_xxx
    X-Wechat-Openid: oABC123...
- è¿”å›: {
    keyId: "uuid",
    name: "MyApp",
    description: "...",
    permissions: "all",
    enableModelRestriction: true,
    restrictedModels: ["gpt-4"],
    dailyCostLimit: 100,
    totalCostLimit: 5000,
    currentDailyCost: 12.50,
    currentTotalCost: 2345.67,
    createdAt: "2024-01-01",
    expiresAt: "2025-12-31",
    usage: {
      totalRequests: 1234,
      totalTokens: 567890
    }
  }
```

---

### 3.2 é¦–é¡µåŠŸèƒ½èœå•ï¼ˆä¹å®«æ ¼å¸ƒå±€ï¼‰

#### è®¾è®¡ç†å¿µ

- **æç®€é»‘ç™½é£æ ¼**ï¼šç±»ä¼¼ ChatGPT çš„ç®€æ´è®¾è®¡
- **ä¹å®«æ ¼å¸ƒå±€**ï¼š3x3 ç½‘æ ¼å±•ç¤ºåŠŸèƒ½
- **æ— éœ€ç™»å½•**ï¼šç›´æ¥æ˜¾ç¤ºåŠŸèƒ½å…¥å£
- **Key æç¤º**ï¼šæœªé…ç½® Key æ—¶æç¤ºç”¨æˆ·é…ç½®

#### é¡µé¢è®¾è®¡

**æœªé…ç½® Key æ—¶ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    å°å·¾å†’åŠ©æ‰‹ - é¦–é¡µ        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              â”‚
â”‚  âš ï¸  éœ€è¦é…ç½® API Key      â”‚
â”‚                              â”‚
â”‚  ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ  Key       â”‚
â”‚                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   [âš™ï¸  é…ç½® Key]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é…ç½® Key åï¼ˆä¹å®«æ ¼å¸ƒå±€ï¼‰ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å°å·¾å†’åŠ©æ‰‹ - é¦–é¡µ               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å½“å‰ Key: MyApp â–¼ [âš™ï¸ ç®¡ç†]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ ğŸ“…   â”‚ ğŸ’°   â”‚ ğŸ“Š   â”‚          â”‚
â”‚  â”‚ ç­¾åˆ° â”‚ ä½™é¢ â”‚ æ—¥å¿— â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”‚ ğŸ’³   â”‚ ğŸ“‹   ï¿½ï¿½ âš™ï¸   â”‚          â”‚
â”‚  â”‚ å……å€¼ â”‚ æ›´å¤š â”‚ è®¾ç½® â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚  â”‚ â“   â”‚ â„¹ï¸   â”‚      â”‚          â”‚
â”‚  â”‚ å¸®åŠ© â”‚ å…³äº â”‚      â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                  â”‚
â”‚  ğŸ“ˆ æœ¬æœˆç»Ÿè®¡                     â”‚
â”‚  â”œâ”€ æ¶ˆè´¹: Â¥ 234.56              â”‚
â”‚  â”œâ”€ ç­¾åˆ°: 15 å¤©                 â”‚
â”‚  â””â”€ å‰©ä½™é¢åº¦: Â¥ 9,765.44        â”‚
â”‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### åŠŸèƒ½æ¨¡å—ï¼ˆä¹å®«æ ¼ï¼‰

1. **ğŸ“… ç­¾åˆ°** - æ¯æ—¥ç­¾åˆ°é¢†ç§¯åˆ†
2. **ğŸ’° ä½™é¢** - æŸ¥çœ‹ä½™é¢å’Œé…é¢ä¿¡æ¯
3. **ğŸ“Š æ—¥å¿—** - æŸ¥çœ‹æ¶ˆè´¹æ—¥å¿—
4. **ğŸ’³ å……å€¼** - ä¸ºå½“å‰ Key å……å€¼
5. **ğŸ“‹ æ›´å¤š** - æ›´å¤šåŠŸèƒ½ï¼ˆé¢„ç•™ï¼‰
6. **âš™ï¸ è®¾ç½®** - åº”ç”¨è®¾ç½®
7. **â“ å¸®åŠ©** - å¸®åŠ©æ–‡æ¡£
8. **â„¹ï¸ å…³äº** - å…³äºå°ç¨‹åº

---

### 3.3 ç­¾åˆ°åŠŸèƒ½

#### ä¸šåŠ¡è§„åˆ™

- æ¯ä¸ª API Key æ¯å¤©åªèƒ½ç­¾åˆ°ä¸€æ¬¡
- æ¯ä¸ªå¾®ä¿¡ç”¨æˆ·ï¼ˆopenidï¼‰æ¯å¤©æœ€å¤šç­¾åˆ° N æ¬¡ï¼ˆé…ç½®é¡¹ï¼šCHECKIN_LIMIT_PER_USER_PER_DAYï¼Œé»˜è®¤ 5ï¼‰
- ç­¾åˆ°æˆåŠŸå¯æ‰©å±• Key çš„ totalCostLimitï¼ˆå¦‚ +100 å…ƒé…é¢ï¼‰
- æ”¯æŒè¿ç»­ç­¾åˆ°ç»Ÿè®¡
- ç­¾åˆ°è®°å½•å­˜å‚¨åœ¨ Redis
- é…é¢å˜æ›´å†å²ä¿ç•™ 12 å°æ—¶ï¼ˆç”¨äºå®¡è®¡ï¼‰

#### ç­¾åˆ°é™åˆ¶ç­–ç•¥

```javascript
// åŒé‡éªŒè¯æœºåˆ¶
1. Key çº§åˆ«ï¼šæ¯ä¸ª Key æ¯å¤©åªèƒ½ç­¾åˆ° 1 æ¬¡
2. ç”¨æˆ·çº§åˆ«ï¼šæ¯ä¸ª openid æ¯å¤©æœ€å¤šç­¾åˆ° N æ¬¡ï¼ˆè·¨æ‰€æœ‰ Keyï¼‰

// ç¤ºä¾‹åœºæ™¯
ç”¨æˆ· A (openid: oABC123) æœ‰ 3 ä¸ª Key
- ä»Šå¤©ç»™ Key1 ç­¾åˆ° âœ…ï¼ˆç”¨æˆ·ç­¾åˆ°æ¬¡æ•° 1/5ï¼‰
- ä»Šå¤©ç»™ Key2 ç­¾åˆ° âœ…ï¼ˆç”¨æˆ·ç­¾åˆ°æ¬¡æ•° 2/5ï¼‰
- ä»Šå¤©ç»™ Key1 å†æ¬¡ç­¾åˆ° âŒï¼ˆKey1 ä»Šå¤©å·²ç­¾åˆ°ï¼‰
- ç»§ç»­ç»™ Key3ã€Key4ã€Key5 ç­¾åˆ° âœ…ï¼ˆç”¨æˆ·ç­¾åˆ°æ¬¡æ•° 3-5/5ï¼‰
- ç»™ Key6 ç­¾åˆ° âŒï¼ˆç”¨æˆ·ä»Šå¤©ç­¾åˆ°æ¬¡æ•°å·²ç”¨å®Œï¼‰
```

#### é¡µé¢å±•ç¤ºï¼ˆæ”¯æŒ Key ä¸‹æ‹‰é€‰æ‹©ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    æ¯æ—¥ç­¾åˆ°                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€‰æ‹© Key:                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ MyApp                    â–¼  â”‚   â”‚  â† ä¸‹æ‹‰é€‰æ‹©å™¨
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  ç­¾åˆ°çŠ¶æ€:                            â”‚
â”‚  â”œâ”€ ä»Šæ—¥å·²ç­¾åˆ° âœ…                   â”‚
â”‚  â”œâ”€ è·å¾—é…é¢: Â¥100                  â”‚
â”‚  â”œâ”€ æ–°é…é¢: Â¥10,100 / Â¥10,100      â”‚
â”‚  â”œâ”€ è¿ç»­ç­¾åˆ°: 15 å¤©                 â”‚
â”‚  â””â”€ æœ€é•¿çºªå½•: 30 å¤©                 â”‚
â”‚                                      â”‚
â”‚  ç­¾åˆ°é™åˆ¶:                            â”‚
â”‚  â”œâ”€ ä»Šæ—¥ç­¾åˆ°æ¬¡æ•°: 3 / 5            â”‚
â”‚  â””â”€ å‰©ä½™æ¬¡æ•°: 2                     â”‚
â”‚  âš ï¸ æ³¨æ„ï¼šæ¯ä¸ªå¾®ä¿¡ç”¨æˆ·æ¯å¤©æœ€å¤šç­¾åˆ°5æ¬¡â”‚
â”‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ç«‹å³ç­¾åˆ°]                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                      â”‚
â”‚  ç­¾åˆ°å†å²ï¼ˆæœ€è¿‘10æ¬¡ï¼‰:                â”‚
â”‚  â”œâ”€ 2024-01-15: âœ… è·å¾— Â¥100        â”‚
â”‚  â”œâ”€ 2024-01-14: âœ… è·å¾— Â¥100        â”‚
â”‚  â””â”€ ...                              â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.4 ä½™é¢æŸ¥è¯¢åŠŸèƒ½

#### é¡µé¢å±•ç¤ºï¼ˆæ”¯æŒ Key é€‰æ‹©ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        ä½™é¢æŸ¥è¯¢                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å½“å‰ Key: [MyApp      â–¼]      â”‚
â”‚           ç‚¹å‡»åˆ‡æ¢å…¶ä»– Key       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å½“å‰ä½™é¢: Â¥ 9,765.44   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  é…é¢ä¿¡æ¯:                       â”‚
â”‚  â”œâ”€ æ—¥é™é¢: Â¥ 100.00           â”‚
â”‚  â”‚   å·²ç”¨: Â¥ 12.50 (12.5%)    â”‚
â”‚  â”œâ”€ æ€»é™é¢: Â¥ 5,000.00         â”‚
â”‚  â”‚   å·²ç”¨: Â¥ 2,345.67 (46.9%)  â”‚
â”‚  â””â”€ Opuså‘¨é™é¢: Â¥ 500.00       â”‚
â”‚      å·²ç”¨: Â¥ 123.45 (24.7%)    â”‚
â”‚                                 â”‚
â”‚  ä½¿ç”¨ç»Ÿè®¡ï¼ˆæœ¬æœˆï¼‰:               â”‚
â”‚  â”œâ”€ Claude: 15,000 tokens      â”‚
â”‚  â”œâ”€ Gemini: 8,500 tokens       â”‚
â”‚  â””â”€ OpenAI: 3,200 tokens       â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [å……å€¼] [è¯¦æƒ…]           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯ç‚¹

```
GET /wechat/balance
Headers: X-API-Key: cr_xxx

Response: {
  keyId: "uuid",
  keyName: "MyApp",
  permissions: "all",
  quotaInfo: {
    dailyCostLimit: 100,
    totalCostLimit: 5000,
    weeklyOpusCostLimit: 500,
    currentDailyCost: 12.50,
    currentTotalCost: 2345.67,
    currentWeeklyOpusCost: 123.45,
    remaining: 9765.44
  },
  stats: {
    claude: { tokens: 15000, cost: 3.75 },
    gemini: { tokens: 8500, cost: 1.27 },
    openai: { tokens: 3200, cost: 2.45 }
  },
  usage: {
    totalRequests: 1234,
    totalTokens: 567890
  }
}
```

---

### 3.5 æ¶ˆè´¹æ—¥å¿—åŠŸèƒ½

#### é¡µé¢å±•ç¤ºï¼ˆæ”¯æŒ Key é€‰æ‹©ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        æ¶ˆè´¹æ—¥å¿—æŸ¥è¯¢                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Key: [MyApp          â–¼]               â”‚
â”‚      ç‚¹å‡»åˆ‡æ¢å…¶ä»– Key                 â”‚
â”‚ æ—¶é—´: [æœ€è¿‘7å¤©       â–¼]               â”‚
â”‚                                        â”‚
â”‚ [æœç´¢] [åˆ·æ–°]                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ—¶é—´        â”‚ æ¨¡å‹        â”‚ Tokens â”‚æˆæœ¬â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”¤
â”‚ 11-05 08:30â”‚ claude-3-op â”‚12.5K   â”‚3.12â”‚
â”‚ 11-04 15:22â”‚ gpt-4       â”‚ 5.2K   â”‚1.87â”‚
â”‚ 11-03 09:15â”‚ gemini-pro  â”‚ 8.1K   â”‚1.21â”‚
â”‚ ...        â”‚ ...         â”‚ ...    â”‚... â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯ç‚¹

```
GET /wechat/logs
Headers: X-API-Key: cr_xxx
Query: {
  startDate: "2024-01-01",
  endDate: "2024-11-05",
  model: "",            // å¯é€‰ï¼šæŒ‰æ¨¡å‹ç­›é€‰
  limit: 20,
  offset: 0
}

Response: {
  keyId: "uuid",
  keyName: "MyApp",
  total: 2500,      // æ€»è®°å½•æ•°
  totalCost: 45.67,
  logs: [
    {
      date: "2024-11-05",
      time: "08:30:15",
      model: "claude-3-opus",
      inputTokens: 2500,
      outputTokens: 10000,
      cacheCreateTokens: 0,
      cacheReadTokens: 0,
      cost: 3.12,
      timestamp: 1730812345
    },
    // ... æ›´å¤šè®°å½•
  ]
}

POST /wechat/logs/export
Headers: X-API-Key: cr_xxx
Body: {
  startDate: "2024-01-01",
  endDate: "2024-11-05",
  format: "csv|json"
}
Response: {
  exportUrl: "https://...",
  expiresAt: "2024-11-06 00:00:00"
}
```

---

### 3.6 å……å€¼åŠŸèƒ½

#### å……å€¼è¯´æ˜

- **å……å€¼æœ¬è´¨**ï¼šæ‰©å±• Key çš„ totalCostLimitï¼ˆæ€»é…é¢é™åˆ¶ï¼‰
- **å……å€¼å¯¹è±¡**ï¼šå•ä¸ªé€‰ä¸­çš„ API Key
- **æ”¯ä»˜æ–¹å¼**ï¼šå¾®ä¿¡å°ç¨‹åºæ”¯ä»˜ï¼ˆéœ€è¦ openidï¼‰
- **å¼€æ”¾å……å€¼**ï¼šä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½å……å€¼ï¼ˆç”¨è‡ªå·±çš„å¾®ä¿¡æ”¯ä»˜ï¼‰
- **æ”¯ä»˜è®°å½•**ï¼šè®°å½•æ”¯ä»˜è€… openidï¼Œç”¨äºå®¡è®¡å’Œçº çº·å¤„ç†
- **é…é¢å˜æ›´å†å²**ï¼šä¿ç•™ 12 å°æ—¶å®¡è®¡è®°å½•

#### å……å€¼æµç¨‹

```
ç”¨æˆ·é€‰æ‹© Key â†’ è¾“å…¥å……å€¼é‡‘é¢ â†’ å‘èµ·å¾®ä¿¡æ”¯ä»˜
    â†“
æ”¯ä»˜æˆåŠŸå›è°ƒ
    â†“
å¢åŠ  Key çš„ totalCostLimitï¼ˆå¦‚ 1000 â†’ 1100ï¼‰
    â†“
è®°å½•å……å€¼å†å²ï¼ˆtransactionId, amount, payerOpenidï¼‰
    â†“
è®°å½•é…é¢å˜æ›´å†å²ï¼ˆ12å°æ—¶TTLï¼Œç”¨äºå®¡è®¡ï¼‰
    â†“
æ›´æ–°é¡µé¢æ˜¾ç¤ºæ–°é…é¢
```

#### é¡µé¢å±•ç¤ºï¼ˆä¸‹æ‹‰é€‰æ‹© Key - å• Key å……å€¼ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        å……å€¼                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€‰æ‹© Key:                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ MyApp                â–¼  â”‚  â”‚  â† ä¸‹æ‹‰é€‰æ‹©å™¨
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  âš ï¸ å……å€¼ä»…é’ˆå¯¹é€‰ä¸­çš„ Key       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚  å½“å‰é…é¢: Â¥9,765 / Â¥10,000   â”‚
â”‚  â”œâ”€ å·²ç”¨: Â¥235 (2.35%)        â”‚
â”‚  â””â”€ å‰©ä½™: Â¥9,765              â”‚
â”‚                                 â”‚
â”‚  é€‰æ‹©å……å€¼é‡‘é¢ï¼ˆæ‰©å±•é…é¢ï¼‰:       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”         â”‚
â”‚  â”‚Â¥10 â”‚Â¥50 â”‚Â¥100â”‚Â¥200â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”¬â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”       â”‚
â”‚  â”‚Â¥500â”‚Â¥1K â”‚è‡ªå®šä¹‰ â”‚    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”´â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”˜       â”‚
â”‚                                 â”‚
â”‚  å……å€¼åé…é¢: Â¥10,100           â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [ç«‹å³å……å€¼ - MyApp]     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚
â”‚  å……å€¼è¯´æ˜:                       â”‚
â”‚  â€¢ å……å€¼å°†æ‰©å±•è¯¥ Key çš„æ€»é…é¢    â”‚
â”‚  â€¢ ä½¿ç”¨å¾®ä¿¡æ”¯ä»˜                 â”‚
â”‚  â€¢ å……å€¼è®°å½•å°†å…³è”æ‚¨çš„å¾®ä¿¡è´¦å·   â”‚
â”‚  â€¢ ä»»ä½•äººéƒ½èƒ½ä¸ºè¯¥ Key å……å€¼      â”‚
â”‚                                 â”‚
â”‚  æœ€è¿‘å……å€¼ï¼ˆæœ€è¿‘10æ¡ï¼‰:           â”‚
â”‚  â”œâ”€ 2024-01-15: Â¥100 (å¼ ä¸‰)   â”‚
â”‚  â”œâ”€ 2024-01-10: Â¥50 (æå››)    â”‚
â”‚  â””â”€ ...                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯ç‚¹

```
POST /wechat/recharge/init
- åˆå§‹åŒ–å……å€¼è®¢å•ï¼ˆä»…é’ˆå¯¹å•ä¸ªé€‰ä¸­çš„ Keyï¼‰
Headers: {
  X-API-Key: "cr_xxx",
  X-Wechat-Openid: "oABC123..."
}
Body: {
  amount: 100,        // å……å€¼é‡‘é¢ï¼ˆå…ƒï¼‰ï¼Œå°†å¢åŠ åˆ° totalCostLimit
  deviceInfo: {       // è®¾å¤‡ä¿¡æ¯
    platform: "ios|android"
  }
}

Response: {
  orderId: "ORDER_20240115_xxx",
  prepayId: "wx201411101639wchg8ebc6752b0",
  timeStamp: "1414561699",
  nonceStr: "5K8264ILTKCH16CQ550541962SORBT75",
  package: "prepay_id=wx201411101639wchg8ebc6752b0",
  signType: "RSA",
  paySign: "oR9d8PuuPLMz7FPgkm..."
}

POST /wechat/recharge/callback
- å¾®ä¿¡æ”¯ä»˜å›è°ƒï¼ˆå……å€¼æ¬¾é¡¹åˆ°è´¦ï¼‰
Headers: å¾®ä¿¡ç­¾åéªŒè¯
Body: {
  transaction_id: "wx123456789",
  out_trade_no: "ORDER_20241105_xxx",
  total_amount: 100,
  apiKey: "cr_xxx",    // åŠ å¯†ä¼ è¾“
  openid: "oABC123..."  // æ”¯ä»˜è€… openid
}
å¤„ç†é€»è¾‘:
1. éªŒè¯å¾®ä¿¡ç­¾å
2. éªŒè¯æ”¯ä»˜æˆåŠŸ
3. å¢åŠ  Key çš„ totalCostLimitï¼ˆå¦‚ 1000 â†’ 1100ï¼‰
4. è®°å½•å……å€¼å†å²ï¼šrecharge:{keyId}
5. è®°å½•é…é¢å˜æ›´å†å²ï¼šquota_history:{keyId}ï¼ˆ12å°æ—¶TTLï¼‰
6. è¿”å› success

GET /wechat/recharge/history
- è·å–å½“å‰ Key çš„å……å€¼å†å²
Headers: {
  X-API-Key: "cr_xxx",
  X-Wechat-Openid: "oABC123..."
}
Query: {limit: 20, offset: 0}

Response: {
  total: 10,
  records: [
    {
      transactionId: "wx123456789",
      amount: 100,
      payerOpenid: "oABC123...",
      payerNickname: "å¼ ä¸‰",  // å¯é€‰
      status: "success",
      createdAt: "2024-11-05 08:30:00"
    }
  ]
}

GET /wechat/quota-history
- è·å–å½“å‰ Key çš„é…é¢å˜æ›´å†å²ï¼ˆ12 å°æ—¶å†…ï¼‰
Headers: {
  X-API-Key: "cr_xxx"
}

Response: {
  keyId: "uuid",
  keyName: "MyApp",
  currentQuota: 10100,
  history: [
    {
      type: "recharge",
      amount: 100,
      operatorNickname: "å¼ ä¸‰",
      beforeQuota: 10000,
      afterQuota: 10100,
      timestamp: 1737123456,
      timeAgo: "2å°æ—¶å‰",
      transactionId: "wx123..."
    },
    {
      type: "checkin",
      amount: 100,
      operatorNickname: "æå››",
      beforeQuota: 9900,
      afterQuota: 10000,
      timestamp: 1737000000,
      timeAgo: "10å°æ—¶å‰"
    }
  ],
  note: "å†å²è®°å½•ä»…ä¿ç•™12å°æ—¶ï¼Œç”¨äºå®¡è®¡å’Œçº çº·å¤„ç†"
}
```

---

## 4. æ•°æ®åº“å’Œæ•°æ®æ¨¡å‹è®¾è®¡

### 4.1 Redis æ•°æ®ç»“æ„

#### å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯ï¼ˆæœåŠ¡ç«¯ï¼‰

```
wechat_user:{openid}
{
  openid: "oABC123...",
  nickname: "å¼ ä¸‰",        // å¯é€‰ï¼ŒgetUserInfoåè·å–
  avatarUrl: "https://...", // å¯é€‰
  lastLogin: 1737123456,
  createdAt: 1737000000
}
TTL: æ°¸ä¹…
```

#### Key æœ¬åœ°å­˜å‚¨ï¼ˆå°ç¨‹åºç«¯ï¼‰

```javascript
// å­˜å‚¨åœ¨å¾®ä¿¡å°ç¨‹åº Storage
{
  openid: "oABC123...",  // å½“å‰ç”¨æˆ·openid
  keys: [
    {
      apiKey: "cr_xxx...",  // å®Œæ•´çš„API Key
      keyId: "uuid",
      name: "MyApp",
      permissions: "all",
      isActive: true,
      addedAt: "2024-01-15"
    }
  ],
  currentKeyId: "uuid",  // å½“å‰ä½¿ç”¨çš„Key ID
  lastSync: "2024-01-15 08:30:00"
}
```

#### ç­¾åˆ°é™åˆ¶ï¼ˆæ¯æ—¥é‡ç½®ï¼‰

```
checkin_limit:{openid}:{date}
{
  count: 3,                          // ä»Šå¤©å·²ç­¾åˆ°3æ¬¡
  keyIds: ["key_id_1", "key_id_2"],  // ç­¾åˆ°è¿‡çš„Keyåˆ—è¡¨
  date: "2024-01-15"
}
TTL: 86400ç§’ï¼ˆ24å°æ—¶ï¼Œæ¬¡æ—¥è‡ªåŠ¨æ¸…ç†ï¼‰
```

#### ç­¾åˆ°è®°å½•ï¼ˆæœåŠ¡ç«¯ Redisï¼‰

```
checkin:{keyId}:{date}
{
  keyId: "uuid",
  openid: "oABC123...",
  nickname: "å¼ ä¸‰",      // å¯é€‰
  reward: 100,
  timestamp: 1737123456,
  streakDays: 5
}
TTL: æ°¸ä¹…ï¼ˆç”¨äºç»Ÿè®¡è¿ç»­ç­¾åˆ°ï¼‰

checkin:stats:{keyId}
{
  totalCheckins: 30,
  currentStreak: 5,
  longestStreak: 15,
  lastCheckinTime: 1737123456,
  lastCheckinOpenid: "oABC123..."
}
TTL: æ°¸ä¹…
```

#### å……å€¼è®°å½•ï¼ˆæœåŠ¡ç«¯ Redisï¼‰

```
recharge:{keyId}
[
  {
    transactionId: "wx123456789",
    amount: 100,
    payerOpenid: "oABC123...",
    payerNickname: "å¼ ä¸‰",
    timestamp: 1737123456,
    status: "success",
    paymentMethod: "wechat"
  }
]
TTL: æ°¸ä¹…

recharge:stats:{keyId}
{
  totalRecharges: 5,
  totalAmount: 500,
  lastRechargeTime: 1737123456,
  lastRechargeOpenid: "oABC123..."
}
TTL: æ°¸ä¹…
```

#### é…é¢å˜æ›´å†å²ï¼ˆ12å°æ—¶å®¡è®¡ï¼‰â­ æ–°å¢

```
quota_history:{keyId}
[
  {
    type: "recharge|checkin",
    amount: 100,
    operatorOpenid: "oABC123...",
    operatorNickname: "å¼ ä¸‰",
    beforeQuota: 10000,
    afterQuota: 10100,
    timestamp: 1737123456,
    transactionId: "wx123..."  // å……å€¼æ—¶æœ‰
  }
]
TTL: 43200ç§’ï¼ˆ12å°æ—¶ï¼‰
ç”¨é€”: å®¡è®¡å’Œçº çº·å¤„ç†
```

#### API Key ä½¿ç”¨ç»Ÿè®¡ï¼ˆå¤ç”¨ç°æœ‰ï¼‰

```
usage:daily:{date}:{keyId}:{model}
{
  inputTokens: 2500,
  outputTokens: 10000,
  cacheCreateTokens: 0,
  cacheReadTokens: 0,
  cost: 3.12,
  platform: "wechat-miniapp"  // æ–°å¢æ ‡è¯†
}
TTL: æŒ‰ç°æœ‰ç­–ç•¥
```

---

## 5. åç«¯ API è®¾è®¡æ±‡æ€»

### 5.1 å¾®ä¿¡ç™»å½•ç›¸å…³

```
POST /wechat/auth/login          - å¾®ä¿¡é™é»˜ç™»å½•ï¼ˆè·å– openidï¼‰
```

### 5.2 Key ç®¡ç†ç›¸å…³

```
POST /wechat/key/validate        - éªŒè¯å®Œæ•´ API Key å¯†é’¥
GET /wechat/key/info             - è·å– Key è¯¦ç»†ä¿¡æ¯
```

### 5.3 ç­¾åˆ°ç›¸å…³

```
POST /wechat/checkin             - æ‰§è¡Œç­¾åˆ°ï¼ˆæ‰©å±•é…é¢ï¼‰
GET /wechat/checkin/status       - è·å–ç­¾åˆ°çŠ¶æ€
GET /wechat/checkin/history      - è·å–ç­¾åˆ°å†å²
GET /wechat/checkin/limit        - è·å–å½“å‰ç”¨æˆ·ç­¾åˆ°é™åˆ¶
```

### 5.4 ä½™é¢æŸ¥è¯¢ç›¸å…³

```
GET /wechat/balance              - æŸ¥è¯¢ä½™é¢å’Œé…é¢
GET /wechat/balance/history      - ä½™é¢å˜åŠ¨å†å²
```

### 5.5 æ¶ˆè´¹æ—¥å¿—ç›¸å…³

```
GET /wechat/logs                 - æŸ¥è¯¢æ¶ˆè´¹æ—¥å¿—
POST /wechat/logs/export         - å¯¼å‡ºæ¶ˆè´¹æ—¥å¿—
```

### 5.6 å……å€¼ç›¸å…³

```
POST /wechat/recharge/init       - åˆå§‹åŒ–å……å€¼è®¢å•ï¼ˆæ‰©å±•é…é¢ï¼‰
POST /wechat/recharge/callback   - å¾®ä¿¡æ”¯ä»˜å›è°ƒ
GET /wechat/recharge/history     - å……å€¼å†å²è®°å½•
```

### 5.7 é…é¢å†å²ç›¸å…³ï¼ˆæ–°å¢ï¼‰

```
GET /wechat/quota-history        - è·å–é…é¢å˜æ›´å†å²ï¼ˆ12å°æ—¶å†…ï¼‰
```

### 5.8 å°ç¨‹åºé…ç½®ç›¸å…³

```
GET /wechat/config               - è·å–å°ç¨‹åºé…ç½®
```

---

## 6. å‰ç«¯æŠ€æœ¯æ–¹æ¡ˆ

### 6.1 æŠ€æœ¯æ ˆ

```
æ¡†æ¶: uni-app (Vue 3 ç‰ˆæœ¬)
UI æ¡†æ¶: Vue 3 (Composition API)
çŠ¶æ€ç®¡ç†: Pinia
HTTP è¯·æ±‚: uni.request (å°è£…)
UI ç»„ä»¶åº“: uni-ui (å¯é€‰ uview-ui)
æœ¬åœ°å­˜å‚¨: uni.getStorage / uni.setStorage
æ ·å¼æ–¹æ¡ˆ: SCSS
æ„å»ºå·¥å…·: Vite (uni-app v4+)
åŒ…ç®¡ç†: npm / pnpm
```

### 6.2 å…³é”®æœåŠ¡å±‚è®¾è®¡

#### keyService.jsï¼ˆKey ç®¡ç†æœåŠ¡ï¼‰

```javascript
class KeyService {
  // æ·»åŠ æ–° Key
  async addKey(apiKey) {
    // 1. éªŒè¯ Key æœ‰æ•ˆæ€§
    // 2. ä¿å­˜åˆ°æœ¬åœ° Storage
    // 3. æ›´æ–° Pinia store
  }

  // åˆ‡æ¢å½“å‰ Key
  async switchKey(keyId) {}

  // åˆ é™¤ Key
  async removeKey(keyId) {}

  // è·å–å½“å‰ Key
  getCurrentKey() {}

  // è·å–æ‰€æœ‰ Key
  getAllKeys() {}
}
```

#### apiService.jsï¼ˆAPI è°ƒç”¨å°è£…ï¼‰

```javascript
class ApiService {
  constructor() {
    this.baseURL = 'https://your-domain.com'
  }

  // è‡ªåŠ¨æ·»åŠ  X-API-Key å¤´
  async request(options) {
    const currentKey = keyService.getCurrentKey()
    return uni.request({
      ...options,
      header: {
        'X-API-Key': currentKey.apiKey,
        ...options.header
      }
    })
  }

  // å…·ä½“ä¸šåŠ¡æ–¹æ³•
  async validateKey(apiKey) {}
  async getBalance() {}
  async checkin() {}
  async getLogs(params) {}
}
```

#### storageService.jsï¼ˆæœ¬åœ°å­˜å‚¨ï¼‰

```javascript
class StorageService {
  async setKeys(keys) {
    return uni.setStorage({ key: 'app_keys', data: keys })
  }

  async getKeys() {
    return uni.getStorage({ key: 'app_keys' })
  }

  async setCurrentKey(keyId) {
    return uni.setStorage({ key: 'current_key_id', data: keyId })
  }

  async getCurrentKeyId() {
    return uni.getStorage({ key: 'current_key_id' })
  }
}
```

### 6.3 Pinia Store è®¾è®¡

#### key.jsï¼ˆKey çŠ¶æ€ç®¡ç†ï¼‰

```javascript
export const useKeyStore = defineStore('key', {
  state: () => ({
    keys: [],
    currentKeyId: null,
    keyInfo: null
  }),

  getters: {
    currentKey: (state) => {
      return state.keys.find((k) => k.keyId === state.currentKeyId)
    },
    hasKeys: (state) => state.keys.length > 0
  },

  actions: {
    async loadKeys() {
      // ä» Storage åŠ è½½
    },
    async addKey(apiKey) {
      // æ·»åŠ æ–° Key
    },
    async switchKey(keyId) {
      // åˆ‡æ¢ Key
    },
    async fetchKeyInfo() {
      // è·å– Key è¯¦ç»†ä¿¡æ¯
    }
  }
})
```

---

## 7. UI è®¾è®¡è§„èŒƒï¼ˆæç®€é»‘ç™½é£æ ¼ + åŠŸèƒ½è‰²ï¼‰

### 7.1 è®¾è®¡åŸåˆ™

- **ç®€æ´è‡³ä¸Š**ï¼šå»é™¤ä¸å¿…è¦çš„è£…é¥°ï¼Œä¿æŒç•Œé¢å¹²å‡€
- **é»‘ç™½ä¸ºä¸»**ï¼šä¸»è‰²è°ƒä¸ºé»‘ç™½ç°ï¼ŒåŠŸèƒ½è‰²ä»…ç”¨äºçŠ¶æ€åé¦ˆ
- **å¤§ç•™ç™½**ï¼šå……è¶³çš„ç•™ç™½æå‡å¯è¯»æ€§
- **æ¸…æ™°å±‚çº§**ï¼šé€šè¿‡å­—ä½“å¤§å°å’Œç²—ç»†åŒºåˆ†å±‚çº§
- **åœ†è§’å¡ç‰‡**ï¼šä½¿ç”¨åœ†è§’å¡ç‰‡æ‰¿è½½å†…å®¹
- **å¾®äº¤äº’**ï¼šæ·»åŠ æ‚¬åœã€æŒ‰ä¸‹ç­‰ç»†å¾®åŠ¨æ•ˆæå‡ä½“éªŒ

### 7.2 è‰²å½©æ–¹æ¡ˆï¼ˆæ–¹æ¡ˆ Bï¼šæ·»åŠ æç®€åŠŸèƒ½è‰²ï¼‰âœ¨

#### 7.2.1 ä¸»è‰²ç³»ï¼ˆé»‘ç™½ç°ï¼‰

```javascript
// èƒŒæ™¯è‰²
colors: {
  'bg-primary': '#FFFFFF',      // ä¸»èƒŒæ™¯ï¼ˆä¿æŒçº¯ç™½ï¼‰
  'bg-secondary': '#FAFAFA',    // æ¬¡èƒŒæ™¯ï¼ˆæ›´æµ…ï¼Œå¢åŠ å±‚æ¬¡ï¼‰
  'bg-tertiary': '#F5F5F5',     // ä¸‰çº§èƒŒæ™¯ï¼ˆå¡ç‰‡å†…èƒŒæ™¯ï¼‰

  // æ–‡å­—è‰²ï¼ˆå…³é”®ä¼˜åŒ–ï¼šä¸ç”¨çº¯é»‘ #000000ï¼‰
  'text-primary': '#1A1A1A',    // ä¸»æ–‡å­—ï¼ˆæ·±ç°ï¼Œæ›´æŸ”å’Œï¼‰âœ¨
  'text-secondary': '#666666',  // æ¬¡æ–‡å­—ï¼ˆä¿æŒï¼‰
  'text-tertiary': '#999999',   // ä¸‰çº§æ–‡å­—ï¼ˆæç¤ºæ–‡å­—ï¼‰âœ¨
  'text-disabled': '#BFBFBF',   // ç¦ç”¨çŠ¶æ€ï¼ˆæ›´æ˜æ˜¾ï¼‰âœ¨

  // è¾¹æ¡†å’Œåˆ†å‰²çº¿
  'border-light': '#F0F0F0',    // æµ…è¾¹æ¡†ï¼ˆç»†å¾®åˆ†å‰²ï¼‰âœ¨
  'border-default': '#E0E0E0',  // é»˜è®¤è¾¹æ¡†ï¼ˆä¿æŒï¼‰
  'border-dark': '#D0D0D0',     // æ·±è¾¹æ¡†ï¼ˆå¼ºè°ƒåˆ†å‰²ï¼‰âœ¨

  // å¼ºè°ƒè‰²ï¼ˆçº¯é»‘ä¿ç•™ç”¨äºé‡è¦æŒ‰é’®ï¼‰
  'accent': '#000000',          // çº¯é»‘å¼ºè°ƒï¼ˆç­¾åˆ°æŒ‰é’®ã€å……å€¼æŒ‰é’®ï¼‰
  'accent-hover': '#333333',    // æ‚¬åœçŠ¶æ€ âœ¨
}
```

#### 7.2.2 åŠŸèƒ½è‰²ï¼ˆä»…ç”¨äºçŠ¶æ€åé¦ˆï¼‰âœ¨

```javascript
colors: {
  // æˆåŠŸçŠ¶æ€ï¼ˆç»¿è‰²ç³»ï¼‰
  'success': '#10B981',         // ç»¿è‰²ï¼šç­¾åˆ°æˆåŠŸã€å……å€¼æˆåŠŸã€æ´»è·ƒçŠ¶æ€
  'success-light': '#D1FAE5',   // æµ…ç»¿èƒŒæ™¯ï¼ˆçŠ¶æ€æ ‡ç­¾ï¼‰
  'success-dark': '#059669',    // æ·±ç»¿ï¼ˆæ‚¬åœæ€ï¼‰

  // è­¦å‘ŠçŠ¶æ€ï¼ˆæ©™è‰²ç³»ï¼‰
  'warning': '#F59E0B',         // æ©™è‰²ï¼šè­¦å‘Šã€ä½™é¢ä¸è¶³æé†’
  'warning-light': '#FEF3C7',   // æµ…æ©™èƒŒæ™¯
  'warning-dark': '#D97706',    // æ·±æ©™ï¼ˆæ‚¬åœæ€ï¼‰

  // é”™è¯¯çŠ¶æ€ï¼ˆçº¢è‰²ç³»ï¼‰
  'error': '#EF4444',           // çº¢è‰²ï¼šé”™è¯¯ã€å¤±è´¥ã€å·²è¿‡æœŸ
  'error-light': '#FEE2E2',     // æµ…çº¢èƒŒæ™¯
  'error-dark': '#DC2626',      // æ·±çº¢ï¼ˆæ‚¬åœæ€ï¼‰

  // æç¤ºä¿¡æ¯ï¼ˆè“è‰²ç³»ï¼‰
  'info': '#3B82F6',            // è“è‰²ï¼šæç¤ºä¿¡æ¯ã€å¸®åŠ©è¯´æ˜
  'info-light': '#DBEAFE',      // æµ…è“èƒŒæ™¯
  'info-dark': '#2563EB',       // æ·±è“ï¼ˆæ‚¬åœæ€ï¼‰
}
```

#### 7.2.3 é…è‰²ä½¿ç”¨åœºæ™¯

| åœºæ™¯               | é…è‰²æ–¹æ¡ˆ                                    |
| ------------------ | ------------------------------------------- |
| ä¸»æ–‡å­—             | #1A1A1Aï¼ˆæ·±ç°ï¼Œé¿å…çº¯é»‘åˆºçœ¼ï¼‰              |
| ç­¾åˆ°æˆåŠŸæ ‡ç­¾       | ç»¿è‰²èƒŒæ™¯ + ç»¿è‰²æ–‡å­— + çŠ¶æ€ç‚¹                |
| ä½™é¢ä¸è¶³è­¦å‘Š       | æ©™è‰²èƒŒæ™¯ + æ©™è‰²æ–‡å­— + è­¦å‘Šå›¾æ ‡              |
| Key å·²è¿‡æœŸæç¤º     | çº¢è‰²èƒŒæ™¯ + çº¢è‰²æ–‡å­— + é”™è¯¯å›¾æ ‡              |
| å……å€¼æŒ‰é’®ï¼ˆä¸»æ“ä½œï¼‰ | çº¯é»‘èƒŒæ™¯ + ç™½è‰²æ–‡å­—ï¼ˆä¿æŒæç®€ï¼‰             |
| æ¬¡è¦æŒ‰é’®           | ç™½è‰²èƒŒæ™¯ + é»‘è‰²è¾¹æ¡† + é»‘è‰²æ–‡å­—              |
| ç¦ç”¨æŒ‰é’®           | #BFBFBF èƒŒæ™¯ + ç™½è‰²æ–‡å­— + cursor: disabled |

### 7.3 å­—ä½“è§„èŒƒ

```
å¤§æ ‡é¢˜: 20px, bold (é¡µé¢æ ‡é¢˜)
æ ‡é¢˜: 18px, bold (å¡ç‰‡æ ‡é¢˜)
å‰¯æ ‡é¢˜: 16px, medium (èŠ‚æ ‡é¢˜)
æ­£æ–‡: 14px, regular (ä¸»è¦å†…å®¹)
è¯´æ˜æ–‡å­—: 12px, regular (æç¤ºã€è¾…åŠ©ä¿¡æ¯)
å°æ ‡ç­¾: 10px, medium (å¾½ç« ã€æ ‡ç­¾)
```

### 7.4 ç»„ä»¶æ ·å¼ä¼˜åŒ– âœ¨

#### 7.4.1 ä¹å®«æ ¼æŒ‰é’®ï¼ˆæ·»åŠ å¾®äº¤äº’ï¼‰

```vue
<!-- åŸºç¡€æ ·å¼ -->
<view
  class="grid-item"
  :class="{'grid-item-hover': isHovered, 'grid-item-pressed': isPressed}"
>
  <text class="grid-icon">ğŸ“…</text>
  <text class="grid-label">ç­¾åˆ°</text>
</view>

<!-- SCSS æ ·å¼ -->
<style lang="scss">
.grid-item {
  width: 100px;
  height: 100px;
  background: #FFFFFF;
  border: 1px solid #E0E0E0;
  border-radius: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 8px;

  /* æ·»åŠ å¾®äº¤äº’åŠ¨æ•ˆ âœ¨ */
  transition: all 0.2s ease;

  &:hover {
    border-color: #D0D0D0;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    transform: translateY(-2px);
  }

  &:active {
    transform: scale(0.95);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.06);
  }
}

.grid-icon {
  font-size: 32px;
}

.grid-label {
  font-size: 14px;
  font-weight: 500;
  color: #1A1A1A;
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… hover æ‚¬åœæ•ˆæœï¼ˆè¾¹æ¡†å˜æ·± + é˜´å½± + ä¸Šç§» 2pxï¼‰
- âœ… active æŒ‰ä¸‹æ•ˆæœï¼ˆscale-95 ç¼©æ”¾ï¼‰
- âœ… å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»ï¼ˆtransition: all 0.2sï¼‰

#### 7.4.2 å¡ç‰‡æ ·å¼ï¼ˆå¢å¼ºå±‚æ¬¡æ„Ÿï¼‰

```vue
<view class="card">
  <view class="card-header">
    <text class="card-title">é…é¢ä¿¡æ¯</text>
  </view>
  <view class="card-divider"></view>
  <view class="card-body">
    <text class="card-text">...</text>
  </view>
</view>

<style lang="scss">
.card {
  background: #FFFFFF;
  border: 1px solid #E0E0E0;
  border-radius: 12px;
  padding: 16px;
  margin-bottom: 16px;

  /* é»˜è®¤æ·»åŠ è½»å¾®é˜´å½± âœ¨ */
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
  transition: all 0.2s ease;

  &:hover {
    border-color: #D0D0D0;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);
  }
}

.card-header {
  margin-bottom: 12px;
}

.card-title {
  font-size: 16px;
  font-weight: 600;
  color: #1A1A1A;
}

.card-divider {
  height: 1px;
  background: #F0F0F0;
  margin: 12px 0;
}

.card-body {
  .card-text {
    font-size: 14px;
    color: #666666;
    line-height: 1.6;
  }
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… é»˜è®¤æ·»åŠ è½»å¾®é˜´å½±ï¼ˆshadow-smï¼‰
- âœ… æ‚¬åœæ—¶é˜´å½±åŠ æ·±
- âœ… å†…éƒ¨æ·»åŠ åˆ†å‰²çº¿å¢åŠ å±‚æ¬¡
- âœ… æ ‡é¢˜åŠ ç²—çªå‡º

#### 7.4.3 æŒ‰é’®æ ·å¼ï¼ˆä¸»æŒ‰é’®å’Œæ¬¡æŒ‰é’®ï¼‰

```vue
<!-- ä¸»æŒ‰é’®ï¼ˆå……å€¼ã€ç­¾åˆ°ç­‰ä¸»æ“ä½œï¼‰-->
<button class="btn btn-primary">ç«‹å³ç­¾åˆ°</button>

<!-- æ¬¡æŒ‰é’®ï¼ˆå–æ¶ˆã€è¿”å›ç­‰ï¼‰ -->
<button class="btn btn-secondary">å–æ¶ˆ</button>

<!-- ç¦ç”¨æŒ‰é’® -->
<button class="btn btn-primary" disabled>å·²ç­¾åˆ°</button>

<style lang="scss">
.btn {
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 500;
  border: none;
  transition: all 0.2s ease;
  cursor: pointer;

  /* é˜²æ­¢æ–‡å­—é€‰ä¸­ */
  user-select: none;

  &:active {
    transform: scale(0.98);
  }
}

/* ä¸»æŒ‰é’®ï¼ˆçº¯é»‘èƒŒæ™¯ï¼‰âœ¨ */
.btn-primary {
  background: #000000;
  color: #FFFFFF;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);

  &:hover {
    background: #333333;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
  }

  &:disabled {
    background: #BFBFBF;
    color: #FFFFFF;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
  }
}

/* æ¬¡æŒ‰é’®ï¼ˆç™½è‰²èƒŒæ™¯ + é»‘è‰²è¾¹æ¡†ï¼‰âœ¨ */
.btn-secondary {
  background: #FFFFFF;
  color: #1A1A1A;
  border: 1px solid #E0E0E0;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);

  &:hover {
    background: #FAFAFA;
    border-color: #D0D0D0;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
  }

  &:disabled {
    background: #F5F5F5;
    color: #BFBFBF;
    border-color: #E0E0E0;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
  }
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… å¢å¤§å†…è¾¹è·ï¼ˆæ›´å¥½çš„ç‚¹å‡»åŒºåŸŸï¼‰
- âœ… æ‚¬åœæ—¶èƒŒæ™¯å˜æµ… + é˜´å½±åŠ æ·±
- âœ… æŒ‰ä¸‹æ—¶è½»å¾®ç¼©æ”¾ï¼ˆscale-98ï¼‰
- âœ… ç¦ç”¨çŠ¶æ€æ˜ç¡®ï¼ˆç°è‰² + cursor: not-allowedï¼‰
- âœ… åŒºåˆ†ä¸»æŒ‰é’®å’Œæ¬¡æŒ‰é’®è§†è§‰å±‚çº§

#### 7.4.4 è¾“å…¥æ¡†æ ·å¼ï¼ˆèšç„¦æ€ä¼˜åŒ–ï¼‰

```vue
<input
  type="text"
  class="input-field"
  placeholder="cr_abc123..."
/>

<style lang="scss">
.input-field {
  width: 100%;
  padding: 12px 16px;
  border: 2px solid #E0E0E0;
  border-radius: 8px;
  font-size: 14px;
  color: #1A1A1A;
  background: #FFFFFF;
  outline: none;
  transition: all 0.2s ease;

  /* å ä½ç¬¦é¢œè‰² */
  &::placeholder {
    color: #999999;
  }

  /* èšç„¦æ—¶è¾¹æ¡†å˜é»‘ + é˜´å½±ç¯ âœ¨ */
  &:focus {
    border-color: #000000;
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
  }

  /* é”™è¯¯çŠ¶æ€ âœ¨ */
  &.error {
    border-color: #EF4444;

    &:focus {
      border-color: #EF4444;
      box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
    }
  }

  /* ç¦ç”¨çŠ¶æ€ */
  &:disabled {
    background: #F5F5F5;
    color: #BFBFBF;
    cursor: not-allowed;
  }
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… å¢åŠ è¾¹æ¡†å®½åº¦ï¼ˆborder-2ï¼‰
- âœ… èšç„¦æ—¶è¾¹æ¡†å˜é»‘ + é˜´å½±ç¯ï¼ˆringï¼‰
- âœ… å ä½ç¬¦é¢œè‰²ä¼˜åŒ–ï¼ˆ#999999ï¼‰
- âœ… é”™è¯¯çŠ¶æ€æ ·å¼ï¼ˆçº¢è‰²è¾¹æ¡† + çº¢è‰²é˜´å½±ç¯ï¼‰
- âœ… ç§»é™¤æµè§ˆå™¨é»˜è®¤ outline

#### 7.4.5 ä¸‹æ‹‰é€‰æ‹©å™¨æ ·å¼ï¼ˆè‡ªå®šä¹‰ç®­å¤´ï¼‰

```vue
<view class="select-wrapper">
  <picker
    class="select-field"
    :value="currentIndex"
    :range="keyList"
    @change="onKeyChange"
  >
    <view class="select-display">
      <text class="select-text">{{ currentKey.name }}</text>
      <text class="select-arrow">â–¼</text>
    </view>
  </picker>
</view>

<style lang="scss">
.select-wrapper {
  position: relative;
}

.select-field {
  width: 100%;
}

.select-display {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 12px 16px;
  border: 2px solid #E0E0E0;
  border-radius: 8px;
  background: #FFFFFF;
  cursor: pointer;
  transition: all 0.2s ease;

  &:hover {
    border-color: #D0D0D0;
  }

  &:active {
    border-color: #000000;
    box-shadow: 0 0 0 3px rgba(0, 0, 0, 0.1);
  }
}

.select-text {
  font-size: 14px;
  color: #1A1A1A;
  font-weight: 500;
}

.select-arrow {
  font-size: 10px;
  color: #999999;
  transition: transform 0.2s ease;
}

/* é€‰ä¸­æ—¶ç®­å¤´æ—‹è½¬ âœ¨ */
.select-field.active .select-arrow {
  transform: rotate(180deg);
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… è‡ªå®šä¹‰ä¸‹æ‹‰ç®­å¤´æ ·å¼
- âœ… èšç„¦æ—¶è¾¹æ¡†å˜é»‘ + é˜´å½±ç¯
- âœ… é€‰é¡¹æ˜¾ç¤ºæ›´å¤šä¿¡æ¯ï¼ˆåç§° + æƒé™ + çŠ¶æ€ï¼‰
- âœ… ç‚¹å‡»æ—¶ç®­å¤´æ—‹è½¬åŠ¨æ•ˆ

#### 7.4.6 çŠ¶æ€æ ‡ç­¾æ ·å¼ï¼ˆå¾½ç« ï¼‰âœ¨

```vue
<!-- æˆåŠŸçŠ¶æ€ï¼ˆæ´»è·ƒï¼‰-->
<view class="badge badge-success">
  <view class="badge-dot"></view>
  <text class="badge-text">æ´»è·ƒ</text>
</view>

<!-- è­¦å‘ŠçŠ¶æ€ï¼ˆä½™é¢ä¸è¶³ï¼‰-->
<view class="badge badge-warning">
  <text class="badge-icon">âš ï¸</text>
  <text class="badge-text">ä½™é¢ä¸è¶³</text>
</view>

<!-- é”™è¯¯çŠ¶æ€ï¼ˆå·²è¿‡æœŸï¼‰-->
<view class="badge badge-error">
  <text class="badge-icon">âŒ</text>
  <text class="badge-text">å·²è¿‡æœŸ</text>
</view>

<style lang="scss">
.badge {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 4px 12px;
  border-radius: 999px;
  font-size: 12px;
  font-weight: 500;
  border: 1px solid transparent;
}

/* æˆåŠŸçŠ¶æ€ï¼ˆç»¿è‰²ï¼‰âœ¨ */
.badge-success {
  background: #D1FAE5;
  color: #059669;
  border-color: #A7F3D0;

  .badge-dot {
    width: 6px;
    height: 6px;
    background: #10B981;
    border-radius: 50%;
  }
}

/* è­¦å‘ŠçŠ¶æ€ï¼ˆæ©™è‰²ï¼‰âœ¨ */
.badge-warning {
  background: #FEF3C7;
  color: #D97706;
  border-color: #FDE68A;

  .badge-icon {
    font-size: 14px;
  }
}

/* é”™è¯¯çŠ¶æ€ï¼ˆçº¢è‰²ï¼‰âœ¨ */
.badge-error {
  background: #FEE2E2;
  color: #DC2626;
  border-color: #FECACA;

  .badge-icon {
    font-size: 14px;
  }
}

/* ä¿¡æ¯çŠ¶æ€ï¼ˆè“è‰²ï¼‰âœ¨ */
.badge-info {
  background: #DBEAFE;
  color: #2563EB;
  border-color: #BFDBFE;
}
</style>
```

**æ”¹è¿›ç‚¹ï¼š**

- âœ… æ·»åŠ èƒŒæ™¯è‰²å’Œè¾¹æ¡†ï¼ˆæ›´æ˜æ˜¾ï¼‰
- âœ… åœ†è§’å¾½ç« æ ·å¼ï¼ˆrounded-fullï¼‰
- âœ… æ·»åŠ çŠ¶æ€æŒ‡ç¤ºç‚¹æˆ–å›¾æ ‡
- âœ… åŠŸèƒ½è‰²æ¸…æ™°è¡¨è¾¾çŠ¶æ€

### 7.5 åŠ¨æ•ˆè§„èŒƒ âœ¨

```javascript
// ç»Ÿä¸€çš„åŠ¨ç”»æ—¶é•¿å’Œç¼“åŠ¨å‡½æ•°
transitions: {
  fast: '0.15s ease',      // å¿«é€ŸåŠ¨æ•ˆï¼ˆæŒ‰é’®æŒ‰ä¸‹ï¼‰
  base: '0.2s ease',       // åŸºç¡€åŠ¨æ•ˆï¼ˆæ‚¬åœã€èšç„¦ï¼‰
  slow: '0.3s ease',       // æ…¢é€ŸåŠ¨æ•ˆï¼ˆé¡µé¢åˆ‡æ¢ï¼‰
}

// å¸¸ç”¨åŠ¨ç”»æ•ˆæœ
animations: {
  fadeIn: 'opacity 0.2s ease',
  slideUp: 'transform 0.3s ease',
  scale: 'transform 0.2s ease',
  shadow: 'box-shadow 0.2s ease',
}
```

**åŠ¨æ•ˆä½¿ç”¨åŸåˆ™ï¼š**

- âœ… æ‰€æœ‰äº¤äº’å…ƒç´ å¿…é¡»æœ‰ transition
- âœ… æ‚¬åœæ€ï¼šè¾¹æ¡†/é˜´å½±/èƒŒæ™¯è‰²å˜åŒ–
- âœ… æŒ‰ä¸‹æ€ï¼šè½»å¾®ç¼©æ”¾ï¼ˆscale: 0.95-0.98ï¼‰
- âœ… é¡µé¢åˆ‡æ¢ï¼šæ·¡å…¥æ·¡å‡ºæˆ–æ»‘åŠ¨
- âœ… é¿å…è¿‡åº¦åŠ¨æ•ˆï¼Œä¿æŒæ€§èƒ½

---

## 8. éƒ¨ç½²æ–¹æ¡ˆ

### 8.1 å‰ç«¯éƒ¨ç½²

**å¾®ä¿¡å°ç¨‹åºå®˜æ–¹æ¸ é“ï¼š**

1. ä½¿ç”¨å¾®ä¿¡å¼€å‘è€…å·¥å…·å¼€å‘å’Œè°ƒè¯•
2. ä¸Šä¼ ä»£ç åˆ°å¾®ä¿¡å…¬ä¼—å¹³å°
3. æäº¤å®¡æ ¸
4. å®¡æ ¸é€šè¿‡åå‘å¸ƒ

### 8.2 åç«¯éƒ¨ç½²

#### ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env æ–°å¢
WECHAT_MINIAPP_ENABLED=true                    # å¯ç”¨å¾®ä¿¡å°ç¨‹åºåŠŸèƒ½
WECHAT_APP_ID=xxx                              # å¾®ä¿¡å°ç¨‹åº AppID
WECHAT_APP_SECRET=xxx                          # å¾®ä¿¡å°ç¨‹åº AppSecret
WECHAT_PAYMENT_MCH_ID=xxx                      # å¾®ä¿¡æ”¯ä»˜å•†æˆ·å·
WECHAT_PAYMENT_API_KEY=xxx                     # å¾®ä¿¡æ”¯ä»˜ API å¯†é’¥
WECHAT_PAYMENT_NOTIFY_URL=https://your-domain.com/wechat/recharge/callback

# ç­¾åˆ°é…ç½®
CHECKIN_REWARD_AMOUNT=100                      # æ¯æ¬¡ç­¾åˆ°å¥–åŠ±é…é¢ï¼ˆå…ƒï¼‰
CHECKIN_LIMIT_PER_USER_PER_DAY=5              # æ¯ä¸ªç”¨æˆ·æ¯å¤©æœ€å¤šç­¾åˆ°æ¬¡æ•°

# é…é¢å†å²
QUOTA_HISTORY_TTL=43200                        # é…é¢å˜æ›´å†å²ä¿ç•™æ—¶é—´ï¼ˆç§’ï¼Œ12å°æ—¶ï¼‰
```

#### Dockeré…ç½®

```yaml
# docker-compose.yml
services:
  claude-relay:
    environment:
      - WECHAT_MINIAPP_ENABLED=true
      - WECHAT_APP_ID=${WECHAT_APP_ID}
      - WECHAT_APP_SECRET=${WECHAT_APP_SECRET}
      # ... å…¶ä»–é…ç½®
```

#### ä¾èµ–å®‰è£…

```bash
# å¾®ä¿¡æ”¯ä»˜ SDK
npm install wechatpay-node-v3 --save

# æˆ–ä½¿ç”¨ axios ç›´æ¥è°ƒç”¨å¾®ä¿¡ API
npm install axios --save
```

---

## 9. å¼€å‘æµç¨‹å’Œé‡Œç¨‹ç¢‘

### Phase 1: åŸºç¡€è®¾æ–½å’ŒUIå¼€å‘ï¼ˆç¬¬ 1-2 å‘¨ï¼‰

**å‰ç«¯ï¼š**

- [ ] uni-app é¡¹ç›®åˆå§‹åŒ–
- [ ] ä¹å®«æ ¼é¦–é¡µ UI å¼€å‘
- [ ] Key ç®¡ç†é¡µé¢ UI
- [ ] ç­¾åˆ°é¡µé¢ UI
- [ ] ä½™é¢æŸ¥è¯¢é¡µé¢ UI
- [ ] æ¶ˆè´¹æ—¥å¿—é¡µé¢ UI
- [ ] å……å€¼é¡µé¢ UI
- [ ] å…¬å…±ç»„ä»¶å¼€å‘ï¼ˆKeyé€‰æ‹©å™¨ã€é…ç½®å¼•å¯¼ç­‰ï¼‰
- [ ] æç®€é»‘ç™½ä¸»é¢˜æ ·å¼

**åç«¯ï¼š**

- [ ] å¾®ä¿¡å°ç¨‹åºè·¯ç”±ï¼ˆwechatRoutes.jsï¼‰
- [ ] Key éªŒè¯ä¸­é—´ä»¶ï¼ˆwechatApiKey.jsï¼‰
- [ ] å¾®ä¿¡é…ç½®æ–‡ä»¶ï¼ˆconfig/wechat.jsï¼‰

### Phase 2: æ ¸å¿ƒåŠŸèƒ½å¼€å‘ï¼ˆç¬¬ 3-4 å‘¨ï¼‰

**2.1 Key ç®¡ç†åŠŸèƒ½ï¼ˆ3å¤©ï¼‰**

- [ ] Key éªŒè¯æ¥å£
- [ ] Key ä¿¡æ¯æŸ¥è¯¢æ¥å£
- [ ] å‰ç«¯ Key ç®¡ç†é€»è¾‘
- [ ] æœ¬åœ°å­˜å‚¨å®ç°

**2.2 ç­¾åˆ°åŠŸèƒ½ï¼ˆ2å¤©ï¼‰**

- [ ] ç­¾åˆ°ä¸šåŠ¡æœåŠ¡ï¼ˆcheckinService.jsï¼‰
- [ ] ç­¾åˆ°æ¥å£å®ç°
- [ ] å‰ç«¯ç­¾åˆ°é¡µé¢å¯¹æ¥

**2.3 ä½™é¢æŸ¥è¯¢ï¼ˆ2å¤©ï¼‰**

- [ ] ä½™é¢æŸ¥è¯¢æ¥å£
- [ ] å‰ç«¯ä½™é¢å±•ç¤ºé¡µé¢

**2.4 æ¶ˆè´¹æ—¥å¿—ï¼ˆ3å¤©ï¼‰**

- [ ] æ¶ˆè´¹æ—¥å¿—æœåŠ¡ï¼ˆconsumeLogService.jsï¼‰
- [ ] æ—¥å¿—æŸ¥è¯¢æ¥å£
- [ ] å‰ç«¯æ—¥å¿—åˆ—è¡¨å±•ç¤º
- [ ] æ—¥å¿—å¯¼å‡ºåŠŸèƒ½

**2.5 å……å€¼åŠŸèƒ½ï¼ˆ5å¤©ï¼‰**

- [ ] å……å€¼æœåŠ¡ï¼ˆrechargeService.jsï¼‰
- [ ] å¾®ä¿¡æ”¯ä»˜é›†æˆ
- [ ] æ”¯ä»˜å›è°ƒå¤„ç†
- [ ] å‰ç«¯å……å€¼æµç¨‹

### Phase 3: æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆç¬¬ 5-6 å‘¨ï¼‰

- [ ] åŠŸèƒ½æµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] å®‰å…¨æ€§æµ‹è¯•
- [ ] UI/UX ä¼˜åŒ–
- [ ] å¾®ä¿¡å®¡æ ¸å‡†å¤‡
- [ ] æäº¤å®¡æ ¸
- [ ] æ­£å¼å‘å¸ƒ

**é¢„è®¡æ€»å·¥æœŸï¼š6 å‘¨**

---

## 10. æˆæœ¬å’Œå¤æ‚åº¦è¯„ä¼°

### 10.1 å¼€å‘æˆæœ¬ï¼ˆMVPï¼‰

| åŠŸèƒ½æ¨¡å— | å¤æ‚åº¦ | å‰ç«¯å·¥ä½œé‡ | åç«¯å·¥ä½œé‡ | é£é™© |
| -------- | ------ | ---------- | ---------- | ---- |
| Key ç®¡ç† | â­â­   | 2 å¤©       | 1 å¤©       | ä½   |
| é¦–é¡µUI   | â­     | 2 å¤©       | 0 å¤©       | ä½   |
| ç­¾åˆ°     | â­     | 1 å¤©       | 1 å¤©       | ä½   |
| ä½™é¢æŸ¥è¯¢ | â­     | 1 å¤©       | 1 å¤©       | ä½   |
| æ¶ˆè´¹æ—¥å¿— | â­â­   | 2 å¤©       | 1 å¤©       | ä½   |
| å……å€¼æ”¯ä»˜ | â­â­â­ | 2 å¤©       | 3 å¤©       | ä¸­   |

**æ€»å·¥ä½œé‡ï¼šå‰ç«¯ 10 äººå¤©ï¼Œåç«¯ 7 äººå¤©ï¼Œåˆè®¡çº¦ 17 äººå¤©**

### 10.2 æŠ€æœ¯é£é™©

| é£é™©         | ç­‰çº§ | ç¼“è§£æ–¹æ¡ˆ                       |
| ------------ | ---- | ------------------------------ |
| å¾®ä¿¡å®¡æ ¸è¢«æ‹’ | ä¸­   | æå‰äº†è§£å®¡æ ¸è§„èŒƒï¼Œå‡†å¤‡å……åˆ†èµ„æ–™ |
| æ”¯ä»˜æµç¨‹å¤æ‚ | ä¸­   | ä½¿ç”¨å®˜æ–¹ SDKï¼Œå……åˆ†æµ‹è¯•æ²™ç®±ç¯å¢ƒ |
| Key å®‰å…¨å­˜å‚¨ | ä¸­   | ä½¿ç”¨å¾®ä¿¡ Storageï¼Œé¿å…æ˜æ–‡ä¼ è¾“ |
| è·¨ç«¯å…¼å®¹æ€§   | ä½   | uni-app æ¡†æ¶å·²è§£å†³             |

---

## å…³é”®åŠŸèƒ½å®ç°æ£€æŸ¥æ¸…å•

### Key ç®¡ç†å’Œæ·»åŠ éªŒè¯ âœ…

| éœ€æ±‚               | å®ç°æ–¹å¼                             | çŠ¶æ€ |
| ------------------ | ------------------------------------ | ---- |
| ä»…æ”¯æŒå®Œæ•´å¯†é’¥æ·»åŠ  | è¾“å…¥ cr_xxx â†’ åç«¯éªŒè¯ â†’ ä¿å­˜åˆ°æœ¬åœ°  | âœ…   |
| ä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢   | å‰ç«¯éªŒè¯æ ¼å¼ï¼Œæ‹’ç»é cr\_ å¼€å¤´çš„è¾“å…¥ | âœ…   |
| ä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ Key | æ‰€æœ‰é¡µé¢ä½¿ç”¨ picker ç»„ä»¶ï¼Œä¸å¯è¾“å…¥   | âœ…   |
| å¼€æ”¾ä½¿ç”¨           | ä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½æ·»åŠ å’Œä½¿ç”¨       | âœ…   |

### å¾®ä¿¡ç™»å½•å’Œæƒé™ âœ…

| éœ€æ±‚         | å®ç°æ–¹å¼                       | çŠ¶æ€ |
| ------------ | ------------------------------ | ---- |
| é™é»˜ç™»å½•     | wx.login() åå°è‡ªåŠ¨è·å– openid | âœ…   |
| ä»…ç”¨äºæ”¯ä»˜   | openid ç”¨äºå¾®ä¿¡æ”¯ä»˜å’Œç­¾åˆ°é™åˆ¶  | âœ…   |
| ä¸æ§åˆ¶æ‰€æœ‰æƒ | ä¸å»ºç«‹ Key æ‰€æœ‰æƒæœºåˆ¶          | âœ…   |
| è®°å½•æ“ä½œè€…   | æ‰€æœ‰æ“ä½œè®°å½• openidï¼ˆå®¡è®¡ç”¨ï¼‰  | âœ…   |

### ç­¾åˆ°åŠŸèƒ½ âœ…

| éœ€æ±‚         | å®ç°æ–¹å¼                       | çŠ¶æ€ |
| ------------ | ------------------------------ | ---- |
| Key çº§åˆ«é™åˆ¶ | æ¯ä¸ª Key æ¯å¤©åªèƒ½ç­¾åˆ° 1 æ¬¡     | âœ…   |
| ç”¨æˆ·çº§åˆ«é™åˆ¶ | æ¯ä¸ª openid æ¯å¤©æœ€å¤šç­¾åˆ° N æ¬¡  | âœ…   |
| æ‰©å±•é…é¢     | å¢åŠ  Key çš„ totalCostLimit     | âœ…   |
| è®°å½•å†å²     | è®°å½•åˆ° quota_historyï¼ˆ12å°æ—¶ï¼‰ | âœ…   |

### å……å€¼åŠŸèƒ½ âœ…

| éœ€æ±‚       | å®ç°æ–¹å¼                         | çŠ¶æ€ |
| ---------- | -------------------------------- | ---- |
| æ‰©å±•é…é¢   | å¢åŠ  Key çš„ totalCostLimit       | âœ…   |
| å¼€æ”¾å……å€¼   | ä»»ä½•äººéƒ½èƒ½å……å€¼ï¼ˆç”¨è‡ªå·±å¾®ä¿¡æ”¯ä»˜ï¼‰ | âœ…   |
| è®°å½•æ”¯ä»˜è€… | è®°å½• payerOpenid å’Œ nickname     | âœ…   |
| é…é¢å†å²   | è®°å½•åˆ° quota_historyï¼ˆ12å°æ—¶ï¼‰   | âœ…   |

### é¡µé¢ Key é€‰æ‹©å™¨æ”¯æŒ âœ…

| é¡µé¢           | Key é€‰æ‹©        | ä¸‹æ‹‰å™¨å½¢å¼             | åˆ‡æ¢æ•ˆæœ           | çŠ¶æ€ |
| -------------- | --------------- | ---------------------- | ------------------ | ---- |
| **é¦–é¡µ**       | âœ… æ”¯æŒ         | ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰ | æ˜¾ç¤ºå½“å‰ Key åç§°  | âœ…   |
| **ç­¾åˆ°é¡µ**     | âœ… æ”¯æŒ         | ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰ | åˆ‡æ¢ååˆ·ï¿½ï¿½ç­¾åˆ°çŠ¶æ€ | âœ…   |
| **ä½™é¢æŸ¥è¯¢é¡µ** | âœ… æ”¯æŒ         | ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰ | åˆ‡æ¢ååˆ·æ–°ä½™é¢ä¿¡æ¯ | âœ…   |
| **æ¶ˆè´¹æ—¥å¿—é¡µ** | âœ… æ”¯æŒ         | ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰ | åˆ‡æ¢ååˆ·æ–°æ—¥å¿—åˆ—è¡¨ | âœ…   |
| **å……å€¼é¡µé¢**   | âœ… æ”¯æŒï¼ˆå•é€‰ï¼‰ | ä¸‹æ‹‰é€‰æ‹©å™¨ï¼ˆä¸å¯è¾“å…¥ï¼‰ | åˆ‡æ¢åæ›´æ–°å……å€¼å¯¹è±¡ | âœ…   |

### ä¹å®«æ ¼èœå•ä¼˜åŒ– âœ…

| åŠŸèƒ½    | åŸè®¾è®¡  | ä¿®æ”¹å                           | çŠ¶æ€ |
| ------- | ------- | -------------------------------- | ---- |
| 1. ç­¾åˆ° | ğŸ“… ç­¾åˆ° | ğŸ“… ç­¾åˆ°ï¼ˆæ”¯æŒ Key åˆ‡æ¢ï¼‰         | âœ…   |
| 2. ä½™é¢ | ğŸ’° ä½™é¢ | ğŸ’° ä½™é¢ï¼ˆæ”¯æŒ Key åˆ‡æ¢ï¼‰         | âœ…   |
| 3. æ—¥å¿— | ğŸ“Š æ—¥å¿— | ğŸ“Š æ—¥å¿—ï¼ˆæ”¯æŒ Key åˆ‡æ¢ï¼‰         | âœ…   |
| 4. å……å€¼ | ğŸ’³ å……å€¼ | ğŸ’³ å……å€¼ï¼ˆæ”¯æŒ Key åˆ‡æ¢ï¼Œå• Keyï¼‰ | âœ…   |
| 5. å¯¼å‡º | ğŸ“¤ å¯¼å‡º | ğŸ“‹ æ›´å¤šï¼ˆå·²ç§»é™¤å¯¼å‡ºï¼‰            | âœ…   |
| 6. è®¾ç½® | âš™ï¸ è®¾ç½® | âš™ï¸ è®¾ç½®                          | âœ…   |
| 7. å¸®åŠ© | â“ å¸®åŠ© | â“ å¸®åŠ©                          | âœ…   |
| 8. å…³äº | â„¹ï¸ å…³äº | â„¹ï¸ å…³äº                          | âœ…   |

### åç«¯ API æ”¯æŒ âœ…

| æ¥å£                       | åŠŸèƒ½          | Key/openid è¯†åˆ«æ–¹å¼                   | çŠ¶æ€ |
| -------------------------- | ------------- | ------------------------------------- | ---- |
| POST /wechat/auth/login    | å¾®ä¿¡ç™»å½•      | code â†’ openid                         | âœ…   |
| POST /wechat/key/validate  | éªŒè¯å®Œæ•´å¯†é’¥  | cr_xxx + openid                       | âœ…   |
| GET /wechat/key/info       | è·å– Key è¯¦æƒ… | X-API-Key + X-Wechat-Openid           | âœ…   |
| POST /wechat/checkin       | ç­¾åˆ°          | X-API-Key + X-Wechat-Openid           | âœ…   |
| GET /wechat/balance        | ä½™é¢æŸ¥è¯¢      | X-API-Key + X-Wechat-Openid           | âœ…   |
| GET /wechat/logs           | æ¶ˆè´¹æ—¥å¿—      | X-API-Key + X-Wechat-Openid           | âœ…   |
| POST /wechat/recharge/init | å……å€¼åˆå§‹åŒ–    | X-API-Key + X-Wechat-Openidï¼ˆå• Keyï¼‰ | âœ…   |
| GET /wechat/quota-history  | é…é¢å†å²      | X-API-Keyï¼ˆ12å°æ—¶å†…ï¼‰                 | âœ…   |

---

## 12. åç»­è§„åˆ’

### V2.0 è®¡åˆ’åŠŸèƒ½

- æ•°æ®ç»Ÿè®¡å›¾è¡¨ï¼ˆè¶‹åŠ¿åˆ†æï¼‰
- å¤šè´¦æˆ·å¯¹æ¯”
- æˆæœ¬é¢„è­¦æ¨é€
- æŠ½å¥–/ç§¯åˆ†å•†åŸ

### V3.0 è®¡åˆ’åŠŸèƒ½

- å›¢é˜Ÿåä½œåŠŸèƒ½
- Key åˆ†äº«å’Œæƒé™ç®¡ç†
- æ›´å¤šæ•°æ®å¯¼å‡ºæ ¼å¼

---

## 13. æ€»ç»“

### æ ¸å¿ƒä¼˜åŠ¿

âœ… **è½»é‡çº§å¾®ä¿¡ç™»å½•**ï¼šé™é»˜æˆæƒè·å– openidï¼Œç”¨æˆ·æ— æ„ŸçŸ¥ï¼Œä»…ç”¨äºæ”¯ä»˜å’Œç­¾åˆ°é™åˆ¶
âœ… **æç®€è®¾è®¡**ï¼šç±»ä¼¼ ChatGPT çš„é»‘ç™½é£æ ¼ï¼Œä¸“ä¸šç®€æ´
âœ… **Key ä¸ºä¸­å¿ƒ**ï¼šç›´æ¥å¤ç”¨ CRS çš„ Key ç³»ç»Ÿï¼Œæ— éœ€é‡å¤å¼€å‘
âœ… **å¼€æ”¾ä½¿ç”¨**ï¼šä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½ä½¿ç”¨ï¼Œé€‚åˆå›¢é˜Ÿåä½œå’Œçµæ´»åˆ†äº«
âœ… **æ™ºèƒ½ Key ç®¡ç†**ï¼šä»…æ”¯æŒå®Œæ•´å¯†é’¥æ·»åŠ ï¼Œä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ï¼Œå®‰å…¨å¯æ§
âœ… **å…¨é¡µé¢ Key åˆ‡æ¢**ï¼šæ‰€æœ‰åŠŸèƒ½é¡µé¢éƒ½æ”¯æŒ Key ä¸‹æ‹‰é€‰æ‹©ï¼ˆç­¾åˆ°ã€ä½™é¢ã€æ—¥å¿—ã€å……å€¼ï¼‰
âœ… **æ‰©å±•é…é¢æœºåˆ¶**ï¼šå……å€¼å’Œç­¾åˆ°ç›´æ¥å¢åŠ  Key çš„ totalCostLimit
âœ… **å®¡è®¡æ¸…æ™°**ï¼šé…é¢å˜æ›´å†å²ä¿ç•™ 12 å°æ—¶ï¼Œè®°å½•æ”¯ä»˜è€…å’Œæ“ä½œè€… openid
âœ… **é˜²ç¾Šæ¯›å…š**ï¼šæ¯ä¸ª openid æ¯å¤©æœ€å¤šç­¾åˆ° N æ¬¡ï¼ˆè·¨æ‰€æœ‰ Keyï¼‰
âœ… **å¿«é€Ÿå¼€å‘**ï¼šåŸºäº uni-appï¼Œå‰åç«¯åˆ†ç¦»ï¼Œå¼€å‘æ•ˆç‡é«˜
âœ… **æˆæœ¬å¯æ§**ï¼šå¤ç”¨ç°æœ‰åŸºç¡€è®¾æ–½ï¼Œæ€»å·¥ä½œé‡çº¦ 17 äººå¤©

### MVP äº¤ä»˜èŒƒå›´

1. âœ… å¾®ä¿¡é™é»˜ç™»å½•ï¼ˆè·å– openidï¼‰
2. âœ… Key ç®¡ç†é…ç½®ï¼ˆä»…æ”¯æŒå®Œæ•´å¯†é’¥æ·»åŠ ï¼Œä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ï¼‰
3. âœ… é¦–é¡µä¹å®«æ ¼èœå•ï¼ˆæç®€é»‘ç™½é£æ ¼ï¼‰
4. âœ… æ¯æ—¥ç­¾åˆ°ï¼ˆæ‰©å±•é…é¢ + åŒé‡é™åˆ¶ï¼šKey çº§åˆ« + ç”¨æˆ·çº§åˆ«ï¼‰
5. âœ… ä½™é¢æŸ¥è¯¢ï¼ˆæ˜¾ç¤ºé…é¢å’Œä½¿ç”¨æƒ…å†µï¼‰
6. âœ… æ¶ˆè´¹æ—¥å¿—ï¼ˆæ”¯æŒ Key åˆ‡æ¢ï¼‰
7. âœ… åœ¨çº¿å……å€¼ï¼ˆæ‰©å±•é…é¢ + è®°å½•æ”¯ä»˜è€… + å¾®ä¿¡æ”¯ä»˜ï¼‰
8. âœ… é…é¢å˜æ›´å†å²ï¼ˆ12 å°æ—¶å®¡è®¡ï¼‰

### å…³é”®å®ç°è¯´æ˜

**å……å€¼æœºåˆ¶**ï¼š

- ğŸ”¹ å……å€¼ = æ‰©å±• Key çš„ totalCostLimitï¼ˆæ€»é…é¢ï¼‰
- ğŸ”¹ æ”¯ä»˜æˆåŠŸåç›´æ¥å¢åŠ é…é¢ä¸Šé™ï¼ˆå¦‚ 10000 â†’ 10100ï¼‰
- ğŸ”¹ è®°å½•æ”¯ä»˜è€… openid å’Œå¾®ä¿¡æ˜µç§°
- ğŸ”¹ ä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½å……å€¼ï¼ˆç”¨è‡ªå·±çš„å¾®ä¿¡æ”¯ä»˜ï¼‰

**ç­¾åˆ°æœºåˆ¶**ï¼š

- ğŸ”¹ ç­¾åˆ° = å¢åŠ  Key çš„ totalCostLimit
- ğŸ”¹ æ¯ä¸ª Key æ¯å¤©åªèƒ½ç­¾åˆ° 1 æ¬¡
- ğŸ”¹ æ¯ä¸ª openid æ¯å¤©æœ€å¤šç­¾åˆ° N æ¬¡ï¼ˆé…ç½®é¡¹ï¼Œé»˜è®¤ 5ï¼‰
- ğŸ”¹ é˜²æ­¢åˆ·ç­¾åˆ°ç¾Šæ¯›å…š

**Key ç®¡ç†**ï¼š

- ğŸ”¹ åªæ”¯æŒè¾“å…¥å®Œæ•´å¯†é’¥ï¼ˆcr_xxxï¼‰ï¼Œä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢
- ğŸ”¹ æ‰€æœ‰é¡µé¢ä½¿ç”¨ä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ Keyï¼ˆä¸å¯è¾“å…¥ï¼‰
- ğŸ”¹ ä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½æ·»åŠ å’Œä½¿ç”¨
- ğŸ”¹ å¯†é’¥ä¿å¯†è´£ä»»ç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…

**å®¡è®¡æœºåˆ¶**ï¼š

- ğŸ”¹ æ‰€æœ‰æ“ä½œè®°å½• operatorOpenid
- ğŸ”¹ é…é¢å˜æ›´å†å²ä¿ç•™ 12 å°æ—¶ï¼ˆç”¨äºçº çº·å¤„ç†ï¼‰
- ğŸ”¹ å……å€¼è®°å½•æ°¸ä¹…ä¿å­˜ï¼ˆå«æ”¯ä»˜è€…ä¿¡æ¯ï¼‰
- ğŸ”¹ ç­¾åˆ°è®°å½•æ°¸ä¹…ä¿å­˜ï¼ˆç”¨äºç»Ÿè®¡è¿ç»­ç­¾åˆ°ï¼‰

**å®‰å…¨ç­–ç•¥**ï¼š

- ğŸ”¹ å¾®ï¿½ï¿½é™é»˜ç™»å½•ï¼ˆç”¨æˆ·æ— æ„ŸçŸ¥ï¼‰
- ğŸ”¹ ä¸å»ºç«‹ Key æ‰€æœ‰æƒæœºåˆ¶ï¼ˆå®Œå…¨å¼€æ”¾ï¼‰
- ğŸ”¹ openid ä»…ç”¨äºæ”¯ä»˜å’Œç­¾åˆ°é™åˆ¶
- ğŸ”¹ æ‰€æœ‰ API è¯·æ±‚éœ€åŒæ—¶æºå¸¦ X-API-Key å’Œ X-Wechat-Openid

---

**æ–‡æ¡£ç‰ˆæœ¬**: 6.1
**æœ€åæ›´æ–°**: 2025-01-17
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ

**ä¸»è¦å˜æ›´ï¼ˆv6.1ï¼‰**ï¼š

- âœ… ä¼˜åŒ– UI è®¾è®¡è§„èŒƒï¼šæ·»åŠ æç®€åŠŸèƒ½è‰²ç³»ç»Ÿï¼ˆæ–¹æ¡ˆ Bï¼‰
- âœ… ä¸»æ–‡å­—è‰²ä¼˜åŒ–ï¼š#1A1A1A ä»£æ›¿çº¯é»‘ #000000ï¼Œå‡å°‘è§†è§‰ç–²åŠ³
- âœ… æ–°å¢åŠŸèƒ½è‰²ï¼šæˆåŠŸï¼ˆç»¿ï¼‰ã€è­¦å‘Šï¼ˆæ©™ï¼‰ã€é”™è¯¯ï¼ˆçº¢ï¼‰ã€ä¿¡æ¯ï¼ˆè“ï¼‰
- âœ… è¯¦ç»†çš„ç»„ä»¶æ ·å¼è§„èŒƒï¼šä¹å®«æ ¼ã€å¡ç‰‡ã€æŒ‰é’®ã€è¾“å…¥æ¡†ã€ä¸‹æ‹‰é€‰æ‹©å™¨ã€çŠ¶æ€æ ‡ç­¾
- âœ… æ·»åŠ å¾®äº¤äº’è®¾è®¡ï¼šæ‚¬åœã€æŒ‰ä¸‹ã€èšç„¦ç­‰åŠ¨æ•ˆè§„èŒƒ
- âœ… å®Œæ•´çš„åŠ¨æ•ˆè§„èŒƒï¼štransition æ—¶é•¿å’Œ animation æ•ˆæœ

**ä¸»è¦å˜æ›´ï¼ˆv6.0ï¼‰**ï¼š

- âœ… æ˜ç¡®å……å€¼/ç­¾åˆ° = æ‰©å±• Key çš„ totalCostLimitï¼ˆæ€»é…é¢ï¼‰
- âœ… å¼•å…¥è½»é‡çº§å¾®ä¿¡ç™»å½•ï¼ˆä»…ç”¨äºæ”¯ä»˜å’Œç­¾åˆ°é™åˆ¶ï¼‰
- âœ… Key æ·»åŠ ä»…æ”¯æŒå®Œæ•´å¯†é’¥ï¼Œä¸æ”¯æŒæŒ‰åç§°æŸ¥è¯¢
- âœ… æ‰€æœ‰é¡µé¢ä½¿ç”¨ä¸‹æ‹‰é€‰æ‹©å™¨åˆ‡æ¢ Keyï¼ˆä¸å¯è¾“å…¥ï¼‰
- âœ… Key æ‰€æœ‰æƒå®Œå…¨å¼€æ”¾ï¼ˆä»»ä½•çŸ¥é“å¯†é’¥çš„äººéƒ½èƒ½ä½¿ç”¨ï¼‰
- âœ… ç­¾åˆ°åŒé‡é™åˆ¶ï¼ˆKey çº§åˆ« + openid çº§åˆ«ï¼‰
- âœ… é…é¢å˜æ›´å†å²ï¼ˆ12 å°æ—¶å®¡è®¡ï¼‰
- âœ… è®°å½•æ‰€æœ‰æ“ä½œçš„ operatorOpenid
- âœ… å……å€¼è®°å½•æ”¯ä»˜è€… openid å’Œæ˜µç§°
